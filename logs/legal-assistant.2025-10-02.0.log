2025-10-02 17:24:44.860 [main] INFO  c.r.L.LegalAssistantApplication - Starting LegalAssistantApplication using Java 21.0.5 with PID 31692 (F:\LegalAssistant\target\classes started by river in F:\LegalAssistant)
2025-10-02 17:24:44.862 [main] INFO  c.r.L.LegalAssistantApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-02 17:24:47.171 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-02 17:24:47.406 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@11896af6
2025-10-02 17:24:47.450 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-02 17:24:47.469 [main] INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/legal_assistant (PostgreSQL 17.6)
2025-10-02 17:24:47.479 [main] WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 17.6 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 16.
2025-10-02 17:24:47.562 [main] INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 10
2025-10-02 17:24:47.565 [main] INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
2025-10-02 17:24:47.916 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-10-02 17:24:48.600 [main] INFO  c.r.L.service.PromptTemplateService - 开始初始化提示词模板服务...
2025-10-02 17:24:48.601 [main] INFO  c.r.L.service.PromptTemplateService - 提示词模板服务初始化完成，共加载 7 个模板
2025-10-02 17:24:48.620 [main] INFO  c.r.L.config.OllamaConfig - === Ollama 配置初始化 ===
2025-10-02 17:24:48.620 [main] INFO  c.r.L.config.OllamaConfig - 使用本地 Ollama 服务，不依赖任何云端 AI 服务
2025-10-02 17:24:48.620 [main] INFO  c.r.L.config.OllamaConfig - 确保 Ollama 服务运行在 http://localhost:11434
2025-10-02 17:24:48.620 [main] INFO  c.r.L.config.OllamaConfig - 推荐模型:
2025-10-02 17:24:48.621 [main] INFO  c.r.L.config.OllamaConfig -   - 聊天模型: qwen2:1.5b, llama3.2:3b
2025-10-02 17:24:48.621 [main] INFO  c.r.L.config.OllamaConfig -   - 嵌入模型: nomic-embed-text
2025-10-02 17:24:48.621 [main] INFO  c.r.L.config.OllamaConfig - ========================
2025-10-02 17:24:48.934 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 嵌入模型: nomic-embed-text
2025-10-02 17:24:49.027 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j PGVector 嵌入存储（独立表）
2025-10-02 17:24:49.028 [main] INFO  c.r.L.config.LangChain4jConfig - 连接 PGVector 数据库: localhost:5432/legal_assistant, 表: langchain4j_embeddings, 维度: 768
2025-10-02 17:24:49.705 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化主要聊天客户端，优先使用DeepSeek模型
2025-10-02 17:24:49.733 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆存储库（内存存储）
2025-10-02 17:24:49.735 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆，最大消息数: 15
2025-10-02 17:24:49.738 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆存储库（内存存储）
2025-10-02 17:24:49.739 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆，最大消息数: 30
2025-10-02 17:24:49.740 [main] INFO  c.r.L.service.ChatMemoryService - 聊天记忆服务初始化完成
2025-10-02 17:24:49.770 [main] INFO  c.r.LegalAssistant.config.AiConfig - 设置 Ollama Embedding 模型为主要嵌入模型
2025-10-02 17:24:49.942 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Using the vector table name: vector_store. Is empty: false
2025-10-02 17:24:49.944 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Initializing PGVectorStore schema for table: vector_store in schema: public
2025-10-02 17:24:49.945 [main] INFO  o.s.a.v.pgvector.PgVectorStore - vectorTableValidationsEnabled false
2025-10-02 17:24:49.945 [main] DEBUG o.s.a.v.pgvector.PgVectorStore - Skipping the schema initialization for the table: public.vector_store
2025-10-02 17:24:49.971 [main] INFO  c.r.L.service.AgentService - 混合AI法律顾问代理服务启动
2025-10-02 17:24:49.973 [main] INFO  c.r.L.service.AgentService - 正在初始化混合AI法律顾问代理服务...
2025-10-02 17:24:49.973 [main] INFO  c.r.L.service.AgentService - 配置：混合模式=true, 基础提供者=ollama, 高级提供者=deepseek, 自动降级=true
2025-10-02 17:24:49.973 [main] INFO  c.r.L.service.AgentService - 初始化基础AI服务：ollama (qwen2:1.5b)
2025-10-02 17:24:49.979 [main] INFO  c.r.L.service.AgentService - 基础AI服务初始化成功：qwen2:1.5b
2025-10-02 17:24:49.980 [main] INFO  c.r.L.service.AgentService - 初始化高级AI服务：deepseek (deepseek-chat)
2025-10-02 17:24:50.004 [main] INFO  c.r.L.service.AgentService - 高级AI服务初始化成功：deepseek-chat
2025-10-02 17:24:50.005 [main] INFO  c.r.L.service.AgentService - === 混合AI法律顾问服务初始化完成 ===
2025-10-02 17:24:50.005 [main] INFO  c.r.L.service.AgentService - 基础服务状态：可用 (qwen2:1.5b)
2025-10-02 17:24:50.005 [main] INFO  c.r.L.service.AgentService - 高级服务状态：可用 (deepseek-chat)
2025-10-02 17:24:50.006 [main] INFO  c.r.L.service.AgentService - 自动降级：启用
2025-10-02 17:24:50.006 [main] INFO  c.r.L.service.AgentService - 混合AI架构完全就绪，智能路由已激活。
2025-10-02 17:24:50.006 [main] INFO  c.r.L.service.AgentService - ========================================
2025-10-02 17:24:50.014 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 聊天模型: qwen2:1.5b
2025-10-02 17:24:50.032 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 初始化法律查询路由器...
2025-10-02 17:24:50.032 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 法律查询路由器初始化完成，配置 6 个检索器
2025-10-02 17:24:50.044 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 开始初始化 Advanced Legal RAG 服务...
2025-10-02 17:24:50.045 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG 检索增强器...
2025-10-02 17:24:50.047 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 检索增强器构建完成
2025-10-02 17:24:50.048 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG AI 服务...
2025-10-02 17:24:50.049 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG AI 服务构建完成
2025-10-02 17:24:50.050 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced Legal RAG 服务初始化成功
2025-10-02 17:24:50.482 [main] INFO  c.r.L.service.EtlService - ETL服务初始化完成 - chunk大小: 0, 重叠: 0, 最小块: 0
2025-10-02 17:24:50.578 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化基础聊天客户端，使用Ollama Chat模型
2025-10-02 17:24:50.581 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化高级聊天客户端，使用DeepSeek Chat模型
2025-10-02 17:24:50.584 [main] INFO  c.r.L.config.AsyncConfig - 合同分析异步任务执行器初始化完成: 核心线程数=2, 最大线程数=4, 队列容量=50
2025-10-02 17:24:50.601 [main] INFO  c.r.L.config.AsyncConfig - 通用异步任务执行器初始化完成
2025-10-02 17:24:50.628 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建默认聊天记忆，使用Ollama聊天记忆
2025-10-02 17:24:50.781 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-10-02 17:24:50.827 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-10-02 17:24:51.566 [main] WARN  o.s.b.a.t.ThymeleafAutoConfiguration$DefaultTemplateResolverConfiguration - Cannot find template location: classpath:/templates/ (please add some templates, check your Thymeleaf configuration, or set spring.thymeleaf.check-template-location=false)
2025-10-02 17:24:52.473 [main] INFO  c.r.L.LegalAssistantApplication - Started LegalAssistantApplication in 8.012 seconds (process running for 8.279)
2025-10-02 17:24:52.478 [main] INFO  c.r.L.config.StartupIndexer - 检查是否需要索引法律文档...
2025-10-02 17:24:52.479 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 发现 6 个法律文档，检查是否需要索引...
2025-10-02 17:24:52.567 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 所有法律文档都已被索引，跳过自动索引
2025-10-02 17:25:02.025 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4263d247, method=GET, uri=/api/doc.html, status=200, duration=11ms
2025-10-02 17:25:02.089 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=41384fdb, method=GET, uri=/api/webjars/css/chunk-vendors.f24a310a.css, status=200, duration=8ms
2025-10-02 17:25:02.090 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=05d2e608, method=GET, uri=/api/webjars/css/app.1824bac3.css, status=200, duration=11ms
2025-10-02 17:25:02.092 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0478f1d3, method=GET, uri=/api/webjars/js/app.c31badf5.js, status=200, duration=10ms
2025-10-02 17:25:02.118 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f9f21f1d, method=GET, uri=/api/webjars/js/chunk-vendors.d51cf6f8.js, status=200, duration=34ms
2025-10-02 17:25:02.215 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fb0b839b, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=3ms
2025-10-02 17:25:02.215 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=dd3ce42b, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=3ms
2025-10-02 17:25:02.215 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2712c2a5, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=3ms
2025-10-02 17:25:02.216 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4dd8988f, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=2ms
2025-10-02 17:25:02.218 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b111d1ea, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=4ms
2025-10-02 17:25:02.227 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=85fcb1a7, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=1ms
2025-10-02 17:25:02.228 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f29c349b, method=GET, uri=/api/webjars/js/chunk-2d0da532.591ad7fc.js, status=200, duration=3ms
2025-10-02 17:25:02.228 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cede109a, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=3ms
2025-10-02 17:25:02.238 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5e00d4ed, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=5ms
2025-10-02 17:25:02.240 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=41ea06ab, method=GET, uri=/api/webjars/js/chunk-260d712a.390177fe.js, status=200, duration=16ms
2025-10-02 17:25:02.243 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c6528398, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=5ms
2025-10-02 17:25:02.245 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=24fcbd8f, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=4ms
2025-10-02 17:25:02.245 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fb260172, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=3ms
2025-10-02 17:25:02.251 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c4a94e8a, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=7ms
2025-10-02 17:25:02.253 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f4fce243, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=4ms
2025-10-02 17:25:02.260 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=41ddf920, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=5ms
2025-10-02 17:25:02.429 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=40598fd4, method=GET, uri=/api/v3/api-docs/swagger-config, status=200, duration=31ms
2025-10-02 17:25:02.819 [http-nio-8080-exec-10] INFO  o.s.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 373 ms
2025-10-02 17:25:02.840 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=36a7d9fc, method=GET, uri=/api/v3/api-docs, status=200, duration=404ms
2025-10-02 17:25:02.932 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1ae38ad3, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=3ms
2025-10-02 17:25:02.932 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c595af23, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=3ms
2025-10-02 17:25:02.932 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4f1b9b69, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=3ms
2025-10-02 17:25:02.932 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ace4becc, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=3ms
2025-10-02 17:25:02.932 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0cfeaab7, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=3ms
2025-10-02 17:25:02.947 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2eaea022, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=5ms
2025-10-02 17:25:02.990 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4076b12a, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=2ms
2025-10-02 17:25:02.991 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=962dca16, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=3ms
2025-10-02 17:25:02.991 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c9ad6c34, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=3ms
2025-10-02 17:25:03.001 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fbcf26cc, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=1ms
2025-10-02 17:25:18.915 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-02 17:25:18.918 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-02 18:42:08.724 [main] INFO  c.r.L.LegalAssistantApplication - Starting LegalAssistantApplication using Java 21.0.5 with PID 9304 (F:\LegalAssistant\target\classes started by river in F:\LegalAssistant)
2025-10-02 18:42:08.726 [main] INFO  c.r.L.LegalAssistantApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-02 18:42:11.401 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-02 18:42:11.545 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@62ec4146
2025-10-02 18:42:11.616 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-02 18:42:11.636 [main] INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/legal_assistant (PostgreSQL 17.6)
2025-10-02 18:42:11.642 [main] WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 17.6 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 16.
2025-10-02 18:42:11.732 [main] INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 10
2025-10-02 18:42:11.735 [main] INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
2025-10-02 18:42:12.154 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-10-02 18:42:12.849 [main] INFO  c.r.L.service.PromptTemplateService - 开始初始化提示词模板服务...
2025-10-02 18:42:12.851 [main] INFO  c.r.L.service.PromptTemplateService - 提示词模板服务初始化完成，共加载 7 个模板
2025-10-02 18:42:12.868 [main] INFO  c.r.L.config.OllamaConfig - === Ollama 配置初始化 ===
2025-10-02 18:42:12.869 [main] INFO  c.r.L.config.OllamaConfig - 使用本地 Ollama 服务，不依赖任何云端 AI 服务
2025-10-02 18:42:12.869 [main] INFO  c.r.L.config.OllamaConfig - 确保 Ollama 服务运行在 http://localhost:11434
2025-10-02 18:42:12.869 [main] INFO  c.r.L.config.OllamaConfig - 推荐模型:
2025-10-02 18:42:12.869 [main] INFO  c.r.L.config.OllamaConfig -   - 聊天模型: qwen2:1.5b, llama3.2:3b
2025-10-02 18:42:12.869 [main] INFO  c.r.L.config.OllamaConfig -   - 嵌入模型: nomic-embed-text
2025-10-02 18:42:12.870 [main] INFO  c.r.L.config.OllamaConfig - ========================
2025-10-02 18:42:13.163 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 嵌入模型: nomic-embed-text
2025-10-02 18:42:13.254 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j PGVector 嵌入存储（独立表）
2025-10-02 18:42:13.255 [main] INFO  c.r.L.config.LangChain4jConfig - 连接 PGVector 数据库: localhost:5432/legal_assistant, 表: langchain4j_embeddings, 维度: 768
2025-10-02 18:42:14.041 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化主要聊天客户端，优先使用DeepSeek模型
2025-10-02 18:42:14.069 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆存储库（内存存储）
2025-10-02 18:42:14.071 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆，最大消息数: 15
2025-10-02 18:42:14.075 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆存储库（内存存储）
2025-10-02 18:42:14.075 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆，最大消息数: 30
2025-10-02 18:42:14.076 [main] INFO  c.r.L.service.ChatMemoryService - 聊天记忆服务初始化完成
2025-10-02 18:42:14.105 [main] INFO  c.r.LegalAssistant.config.AiConfig - 设置 Ollama Embedding 模型为主要嵌入模型
2025-10-02 18:42:14.259 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Using the vector table name: vector_store. Is empty: false
2025-10-02 18:42:14.261 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Initializing PGVectorStore schema for table: vector_store in schema: public
2025-10-02 18:42:14.261 [main] INFO  o.s.a.v.pgvector.PgVectorStore - vectorTableValidationsEnabled false
2025-10-02 18:42:14.262 [main] DEBUG o.s.a.v.pgvector.PgVectorStore - Skipping the schema initialization for the table: public.vector_store
2025-10-02 18:42:14.286 [main] INFO  c.r.L.service.AgentService - 混合AI法律顾问代理服务启动
2025-10-02 18:42:14.287 [main] INFO  c.r.L.service.AgentService - 正在初始化混合AI法律顾问代理服务...
2025-10-02 18:42:14.287 [main] INFO  c.r.L.service.AgentService - 配置：混合模式=true, 基础提供者=ollama, 高级提供者=deepseek, 自动降级=true
2025-10-02 18:42:14.288 [main] INFO  c.r.L.service.AgentService - 初始化基础AI服务：ollama (qwen2:1.5b)
2025-10-02 18:42:14.294 [main] INFO  c.r.L.service.AgentService - 基础AI服务初始化成功：qwen2:1.5b
2025-10-02 18:42:14.294 [main] INFO  c.r.L.service.AgentService - 初始化高级AI服务：deepseek (deepseek-chat)
2025-10-02 18:42:14.329 [main] INFO  c.r.L.service.AgentService - 高级AI服务初始化成功：deepseek-chat
2025-10-02 18:42:14.329 [main] INFO  c.r.L.service.AgentService - === 混合AI法律顾问服务初始化完成 ===
2025-10-02 18:42:14.330 [main] INFO  c.r.L.service.AgentService - 基础服务状态：可用 (qwen2:1.5b)
2025-10-02 18:42:14.330 [main] INFO  c.r.L.service.AgentService - 高级服务状态：可用 (deepseek-chat)
2025-10-02 18:42:14.330 [main] INFO  c.r.L.service.AgentService - 自动降级：启用
2025-10-02 18:42:14.330 [main] INFO  c.r.L.service.AgentService - 混合AI架构完全就绪，智能路由已激活。
2025-10-02 18:42:14.331 [main] INFO  c.r.L.service.AgentService - ========================================
2025-10-02 18:42:14.339 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 聊天模型: qwen2:1.5b
2025-10-02 18:42:14.357 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 初始化法律查询路由器...
2025-10-02 18:42:14.357 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 法律查询路由器初始化完成，配置 6 个检索器
2025-10-02 18:42:14.370 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 开始初始化 Advanced Legal RAG 服务...
2025-10-02 18:42:14.370 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG 检索增强器...
2025-10-02 18:42:14.372 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 检索增强器构建完成
2025-10-02 18:42:14.372 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG AI 服务...
2025-10-02 18:42:14.374 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG AI 服务构建完成
2025-10-02 18:42:14.374 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced Legal RAG 服务初始化成功
2025-10-02 18:42:15.529 [main] INFO  c.r.L.service.EtlService - ETL服务初始化完成 - chunk大小: 0, 重叠: 0, 最小块: 0
2025-10-02 18:42:15.613 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化基础聊天客户端，使用Ollama Chat模型
2025-10-02 18:42:15.615 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化高级聊天客户端，使用DeepSeek Chat模型
2025-10-02 18:42:15.617 [main] INFO  c.r.L.config.AsyncConfig - 合同分析异步任务执行器初始化完成: 核心线程数=2, 最大线程数=4, 队列容量=50
2025-10-02 18:42:15.638 [main] INFO  c.r.L.config.AsyncConfig - 通用异步任务执行器初始化完成
2025-10-02 18:42:15.671 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建默认聊天记忆，使用Ollama聊天记忆
2025-10-02 18:42:15.820 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-10-02 18:42:15.862 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-10-02 18:42:16.514 [main] WARN  o.s.b.a.t.ThymeleafAutoConfiguration$DefaultTemplateResolverConfiguration - Cannot find template location: classpath:/templates/ (please add some templates, check your Thymeleaf configuration, or set spring.thymeleaf.check-template-location=false)
2025-10-02 18:42:17.425 [main] INFO  c.r.L.LegalAssistantApplication - Started LegalAssistantApplication in 9.14 seconds (process running for 9.442)
2025-10-02 18:42:17.429 [main] INFO  c.r.L.config.StartupIndexer - 检查是否需要索引法律文档...
2025-10-02 18:42:17.431 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 发现 6 个法律文档，检查是否需要索引...
2025-10-02 18:42:17.536 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 所有法律文档都已被索引，跳过自动索引
2025-10-02 18:43:00.001 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2a3136e0, method=GET, uri=/api/doc.html, status=200, duration=10ms
2025-10-02 18:43:00.071 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e81f6b03, method=GET, uri=/api/webjars/css/chunk-vendors.f24a310a.css, status=200, duration=6ms
2025-10-02 18:43:00.072 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=9f8bfad9, method=GET, uri=/api/webjars/css/app.1824bac3.css, status=200, duration=8ms
2025-10-02 18:43:00.075 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3c01afd6, method=GET, uri=/api/webjars/js/app.c31badf5.js, status=200, duration=9ms
2025-10-02 18:43:00.088 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2789122d, method=GET, uri=/api/webjars/js/chunk-vendors.d51cf6f8.js, status=200, duration=21ms
2025-10-02 18:43:00.206 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=74330506, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=2ms
2025-10-02 18:43:00.208 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b791bfc5, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=3ms
2025-10-02 18:43:00.208 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d9b8f591, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=3ms
2025-10-02 18:43:00.209 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=400295e1, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=3ms
2025-10-02 18:43:00.210 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5cd98eb0, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=4ms
2025-10-02 18:43:00.216 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=eb22b228, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=1ms
2025-10-02 18:43:00.218 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1a5efa4c, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=2ms
2025-10-02 18:43:00.218 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7ccd5af4, method=GET, uri=/api/webjars/js/chunk-2d0da532.591ad7fc.js, status=200, duration=2ms
2025-10-02 18:43:00.221 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b2e3367a, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=5ms
2025-10-02 18:43:00.223 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=40050c70, method=GET, uri=/api/webjars/js/chunk-260d712a.390177fe.js, status=200, duration=12ms
2025-10-02 18:43:00.230 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5f812f50, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=1ms
2025-10-02 18:43:00.230 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1a9c72d2, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=2ms
2025-10-02 18:43:00.232 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e9d7703a, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=4ms
2025-10-02 18:43:00.235 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c8b11658, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=7ms
2025-10-02 18:43:00.236 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c0f6d5f6, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=3ms
2025-10-02 18:43:00.240 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=8c0e2e81, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=7ms
2025-10-02 18:43:00.405 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fc28749d, method=GET, uri=/api/v3/api-docs/swagger-config, status=200, duration=30ms
2025-10-02 18:43:00.766 [http-nio-8080-exec-10] INFO  o.s.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 343 ms
2025-10-02 18:43:00.786 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e1633b46, method=GET, uri=/api/v3/api-docs, status=200, duration=372ms
2025-10-02 18:43:00.865 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f068ebec, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=2ms
2025-10-02 18:43:00.865 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cde3dd5d, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=3ms
2025-10-02 18:43:00.865 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4c759e58, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=2ms
2025-10-02 18:43:00.865 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e32c5de3, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=2ms
2025-10-02 18:43:00.865 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4694cb38, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=2ms
2025-10-02 18:43:00.875 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=19310f9d, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=3ms
2025-10-02 18:43:00.920 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=921e0172, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=2ms
2025-10-02 18:43:00.920 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7e187b39, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=2ms
2025-10-02 18:43:00.920 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3ef06463, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=2ms
2025-10-02 18:43:00.932 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3f68d170, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=2ms
2025-10-02 18:43:36.424 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-02 18:43:36.428 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-02 18:49:29.723 [main] INFO  c.r.L.LegalAssistantApplication - Starting LegalAssistantApplication using Java 21.0.5 with PID 21276 (F:\LegalAssistant\target\classes started by river in F:\LegalAssistant)
2025-10-02 18:49:29.724 [main] INFO  c.r.L.LegalAssistantApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-02 18:49:32.088 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-02 18:49:32.209 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@444ebefd
2025-10-02 18:49:32.254 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-02 18:49:32.276 [main] INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/legal_assistant (PostgreSQL 17.6)
2025-10-02 18:49:32.283 [main] WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 17.6 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 16.
2025-10-02 18:49:32.361 [main] INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 10
2025-10-02 18:49:32.363 [main] INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
2025-10-02 18:49:32.686 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-10-02 18:49:33.382 [main] INFO  c.r.L.service.PromptTemplateService - 开始初始化提示词模板服务...
2025-10-02 18:49:33.383 [main] INFO  c.r.L.service.PromptTemplateService - 提示词模板服务初始化完成，共加载 7 个模板
2025-10-02 18:49:33.405 [main] INFO  c.r.L.config.OllamaConfig - === Ollama 配置初始化 ===
2025-10-02 18:49:33.405 [main] INFO  c.r.L.config.OllamaConfig - 使用本地 Ollama 服务，不依赖任何云端 AI 服务
2025-10-02 18:49:33.405 [main] INFO  c.r.L.config.OllamaConfig - 确保 Ollama 服务运行在 http://localhost:11434
2025-10-02 18:49:33.405 [main] INFO  c.r.L.config.OllamaConfig - 推荐模型:
2025-10-02 18:49:33.406 [main] INFO  c.r.L.config.OllamaConfig -   - 聊天模型: qwen2:1.5b, llama3.2:3b
2025-10-02 18:49:33.406 [main] INFO  c.r.L.config.OllamaConfig -   - 嵌入模型: nomic-embed-text
2025-10-02 18:49:33.406 [main] INFO  c.r.L.config.OllamaConfig - ========================
2025-10-02 18:49:33.699 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 嵌入模型: nomic-embed-text
2025-10-02 18:49:33.785 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j PGVector 嵌入存储（独立表）
2025-10-02 18:49:33.785 [main] INFO  c.r.L.config.LangChain4jConfig - 连接 PGVector 数据库: localhost:5432/legal_assistant, 表: langchain4j_embeddings, 维度: 768
2025-10-02 18:49:34.474 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化主要聊天客户端，优先使用DeepSeek模型
2025-10-02 18:49:34.507 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆存储库（内存存储）
2025-10-02 18:49:34.508 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆，最大消息数: 15
2025-10-02 18:49:34.513 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆存储库（内存存储）
2025-10-02 18:49:34.513 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆，最大消息数: 30
2025-10-02 18:49:34.514 [main] INFO  c.r.L.service.ChatMemoryService - 聊天记忆服务初始化完成
2025-10-02 18:49:34.548 [main] INFO  c.r.LegalAssistant.config.AiConfig - 设置 Ollama Embedding 模型为主要嵌入模型
2025-10-02 18:49:34.723 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Using the vector table name: vector_store. Is empty: false
2025-10-02 18:49:34.725 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Initializing PGVectorStore schema for table: vector_store in schema: public
2025-10-02 18:49:34.725 [main] INFO  o.s.a.v.pgvector.PgVectorStore - vectorTableValidationsEnabled false
2025-10-02 18:49:34.725 [main] DEBUG o.s.a.v.pgvector.PgVectorStore - Skipping the schema initialization for the table: public.vector_store
2025-10-02 18:49:34.753 [main] INFO  c.r.L.service.AgentService - 混合AI法律顾问代理服务启动
2025-10-02 18:49:34.755 [main] INFO  c.r.L.service.AgentService - 正在初始化混合AI法律顾问代理服务...
2025-10-02 18:49:34.755 [main] INFO  c.r.L.service.AgentService - 配置：混合模式=true, 基础提供者=ollama, 高级提供者=deepseek, 自动降级=true
2025-10-02 18:49:34.755 [main] INFO  c.r.L.service.AgentService - 初始化基础AI服务：ollama (qwen2:1.5b)
2025-10-02 18:49:34.775 [main] INFO  c.r.L.service.AgentService - 基础AI服务初始化成功：qwen2:1.5b
2025-10-02 18:49:34.775 [main] INFO  c.r.L.service.AgentService - 初始化高级AI服务：deepseek (deepseek-chat)
2025-10-02 18:49:34.798 [main] INFO  c.r.L.service.AgentService - 高级AI服务初始化成功：deepseek-chat
2025-10-02 18:49:34.798 [main] INFO  c.r.L.service.AgentService - === 混合AI法律顾问服务初始化完成 ===
2025-10-02 18:49:34.798 [main] INFO  c.r.L.service.AgentService - 基础服务状态：可用 (qwen2:1.5b)
2025-10-02 18:49:34.799 [main] INFO  c.r.L.service.AgentService - 高级服务状态：可用 (deepseek-chat)
2025-10-02 18:49:34.799 [main] INFO  c.r.L.service.AgentService - 自动降级：启用
2025-10-02 18:49:34.799 [main] INFO  c.r.L.service.AgentService - 混合AI架构完全就绪，智能路由已激活。
2025-10-02 18:49:34.799 [main] INFO  c.r.L.service.AgentService - ========================================
2025-10-02 18:49:34.807 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 聊天模型: qwen2:1.5b
2025-10-02 18:49:34.822 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 初始化法律查询路由器...
2025-10-02 18:49:34.822 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 法律查询路由器初始化完成，配置 6 个检索器
2025-10-02 18:49:34.833 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 开始初始化 Advanced Legal RAG 服务...
2025-10-02 18:49:34.834 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG 检索增强器...
2025-10-02 18:49:34.836 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 检索增强器构建完成
2025-10-02 18:49:34.836 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG AI 服务...
2025-10-02 18:49:34.837 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG AI 服务构建完成
2025-10-02 18:49:34.838 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced Legal RAG 服务初始化成功
2025-10-02 18:49:35.287 [main] INFO  c.r.L.service.EtlService - ETL服务初始化完成 - chunk大小: 0, 重叠: 0, 最小块: 0
2025-10-02 18:49:35.378 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化基础聊天客户端，使用Ollama Chat模型
2025-10-02 18:49:35.380 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化高级聊天客户端，使用DeepSeek Chat模型
2025-10-02 18:49:35.382 [main] INFO  c.r.L.config.AsyncConfig - 合同分析异步任务执行器初始化完成: 核心线程数=2, 最大线程数=4, 队列容量=50
2025-10-02 18:49:35.401 [main] INFO  c.r.L.config.AsyncConfig - 通用异步任务执行器初始化完成
2025-10-02 18:49:35.428 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建默认聊天记忆，使用Ollama聊天记忆
2025-10-02 18:49:35.599 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-10-02 18:49:35.651 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-10-02 18:49:36.341 [main] WARN  o.s.b.a.t.ThymeleafAutoConfiguration$DefaultTemplateResolverConfiguration - Cannot find template location: classpath:/templates/ (please add some templates, check your Thymeleaf configuration, or set spring.thymeleaf.check-template-location=false)
2025-10-02 18:49:37.272 [main] INFO  c.r.L.LegalAssistantApplication - Started LegalAssistantApplication in 7.951 seconds (process running for 8.219)
2025-10-02 18:49:37.277 [main] INFO  c.r.L.config.StartupIndexer - 检查是否需要索引法律文档...
2025-10-02 18:49:37.278 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 发现 6 个法律文档，检查是否需要索引...
2025-10-02 18:49:37.374 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 所有法律文档都已被索引，跳过自动索引
2025-10-02 18:49:43.670 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=51e26a17, method=GET, uri=/api/doc.html, status=200, duration=14ms
2025-10-02 18:49:43.740 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a1a30b1c, method=GET, uri=/api/webjars/css/chunk-vendors.f24a310a.css, status=200, duration=5ms
2025-10-02 18:49:43.743 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=8c6ce7e3, method=GET, uri=/api/webjars/css/app.1824bac3.css, status=200, duration=9ms
2025-10-02 18:49:43.744 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2549a6ba, method=GET, uri=/api/webjars/js/app.c31badf5.js, status=200, duration=8ms
2025-10-02 18:49:43.762 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1e68cc41, method=GET, uri=/api/webjars/js/chunk-vendors.d51cf6f8.js, status=200, duration=26ms
2025-10-02 18:49:43.874 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=aab6b859, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=3ms
2025-10-02 18:49:43.874 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c1bfeaad, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=2ms
2025-10-02 18:49:43.875 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4aff852c, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=1ms
2025-10-02 18:49:43.875 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=74ee0381, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=2ms
2025-10-02 18:49:43.881 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3de2c14e, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=5ms
2025-10-02 18:49:43.891 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=81ad6267, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=3ms
2025-10-02 18:49:43.891 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=552c3007, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=4ms
2025-10-02 18:49:43.891 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=079531f0, method=GET, uri=/api/webjars/js/chunk-2d0da532.591ad7fc.js, status=200, duration=4ms
2025-10-02 18:49:43.896 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=8305c252, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=3ms
2025-10-02 18:49:43.899 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=14c473ff, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=6ms
2025-10-02 18:49:43.903 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=80147257, method=GET, uri=/api/webjars/js/chunk-260d712a.390177fe.js, status=200, duration=16ms
2025-10-02 18:49:43.906 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=21010c39, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=2ms
2025-10-02 18:49:43.906 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d88a3b73, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=2ms
2025-10-02 18:49:43.912 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b725aa44, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=7ms
2025-10-02 18:49:43.914 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4eb0c49d, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=2ms
2025-10-02 18:49:43.916 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f30038ac, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=4ms
2025-10-02 18:49:44.082 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=17dd129a, method=GET, uri=/api/v3/api-docs/swagger-config, status=200, duration=31ms
2025-10-02 18:49:44.438 [http-nio-8080-exec-5] INFO  o.s.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 341 ms
2025-10-02 18:49:44.459 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=9f465b13, method=GET, uri=/api/v3/api-docs, status=200, duration=370ms
2025-10-02 18:49:44.540 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0acac025, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=1ms
2025-10-02 18:49:44.541 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=33a07225, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=2ms
2025-10-02 18:49:44.541 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=01e8a684, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=2ms
2025-10-02 18:49:44.541 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=14d5a44d, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=2ms
2025-10-02 18:49:44.541 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=9a68891f, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=2ms
2025-10-02 18:49:44.549 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e2ba8c4b, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=3ms
2025-10-02 18:49:44.592 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=11a2134b, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=2ms
2025-10-02 18:49:44.592 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b8b1808a, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=2ms
2025-10-02 18:49:44.593 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cff8ed30, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=3ms
2025-10-02 18:49:44.605 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4fcdd3b0, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=2ms
2025-10-02 18:49:50.995 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d1286ed4, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=1ms
2025-10-02 18:49:50.995 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=bca3e896, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=1ms
2025-10-02 18:49:50.998 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2aa1c558, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=4ms
2025-10-02 18:49:51.846 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3a63e0dd, method=GET, uri=/api/health, status=200, duration=13ms
2025-10-02 18:49:51.878 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7883dc91, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=6ms
2025-10-02 18:49:55.582 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=98f681fb, method=GET, uri=/api/health/info, status=200, duration=1ms
2025-10-02 18:50:03.070 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=613f4c3a, method=GET, uri=/api/health/detailed, status=200, duration=4475ms
2025-10-02 18:50:12.329 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=12ccd707, method=GET, uri=/api/health/deepseek, status=200, duration=5536ms
2025-10-02 18:50:30.742 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b7d52ab9, method=GET, uri=/api/health/ai/test, status=200, duration=15621ms
2025-10-02 18:50:48.994 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3e542dd4, method=GET, uri=/api/health/agent, status=200, duration=1ms
2025-10-02 18:50:57.662 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-02 18:50:57.667 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-02 19:55:22.215 [main] INFO  c.r.L.LegalAssistantApplication - Starting LegalAssistantApplication using Java 21.0.5 with PID 31732 (F:\LegalAssistant\target\classes started by river in F:\LegalAssistant)
2025-10-02 19:55:22.216 [main] INFO  c.r.L.LegalAssistantApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-02 19:55:24.748 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-02 19:55:24.895 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@444ebefd
2025-10-02 19:55:24.952 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-02 19:55:24.970 [main] INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/legal_assistant (PostgreSQL 17.6)
2025-10-02 19:55:24.974 [main] WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 17.6 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 16.
2025-10-02 19:55:25.066 [main] INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 10
2025-10-02 19:55:25.069 [main] INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
2025-10-02 19:55:25.517 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-10-02 19:55:26.268 [main] INFO  c.r.L.service.PromptTemplateService - 开始初始化提示词模板服务...
2025-10-02 19:55:26.270 [main] INFO  c.r.L.service.PromptTemplateService - 提示词模板服务初始化完成，共加载 7 个模板
2025-10-02 19:55:26.286 [main] INFO  c.r.L.config.OllamaConfig - === Ollama 配置初始化 ===
2025-10-02 19:55:26.286 [main] INFO  c.r.L.config.OllamaConfig - 使用本地 Ollama 服务，不依赖任何云端 AI 服务
2025-10-02 19:55:26.286 [main] INFO  c.r.L.config.OllamaConfig - 确保 Ollama 服务运行在 http://localhost:11434
2025-10-02 19:55:26.286 [main] INFO  c.r.L.config.OllamaConfig - 推荐模型:
2025-10-02 19:55:26.286 [main] INFO  c.r.L.config.OllamaConfig -   - 聊天模型: qwen2:1.5b, llama3.2:3b
2025-10-02 19:55:26.287 [main] INFO  c.r.L.config.OllamaConfig -   - 嵌入模型: nomic-embed-text
2025-10-02 19:55:26.287 [main] INFO  c.r.L.config.OllamaConfig - ========================
2025-10-02 19:55:26.603 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 嵌入模型: nomic-embed-text
2025-10-02 19:55:26.730 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j PGVector 嵌入存储（独立表）
2025-10-02 19:55:26.730 [main] INFO  c.r.L.config.LangChain4jConfig - 连接 PGVector 数据库: localhost:5432/legal_assistant, 表: langchain4j_embeddings, 维度: 768
2025-10-02 19:55:27.471 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化主要聊天客户端，优先使用DeepSeek模型
2025-10-02 19:55:27.499 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆存储库（内存存储）
2025-10-02 19:55:27.500 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆，最大消息数: 15
2025-10-02 19:55:27.504 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆存储库（内存存储）
2025-10-02 19:55:27.504 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆，最大消息数: 30
2025-10-02 19:55:27.504 [main] INFO  c.r.L.service.ChatMemoryService - 聊天记忆服务初始化完成
2025-10-02 19:55:27.534 [main] INFO  c.r.LegalAssistant.config.AiConfig - 设置 Ollama Embedding 模型为主要嵌入模型
2025-10-02 19:55:27.713 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Using the vector table name: vector_store. Is empty: false
2025-10-02 19:55:27.715 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Initializing PGVectorStore schema for table: vector_store in schema: public
2025-10-02 19:55:27.715 [main] INFO  o.s.a.v.pgvector.PgVectorStore - vectorTableValidationsEnabled false
2025-10-02 19:55:27.716 [main] DEBUG o.s.a.v.pgvector.PgVectorStore - Skipping the schema initialization for the table: public.vector_store
2025-10-02 19:55:27.759 [main] INFO  c.r.L.service.AgentService - 混合AI法律顾问代理服务启动
2025-10-02 19:55:27.761 [main] INFO  c.r.L.service.AgentService - 正在初始化混合AI法律顾问代理服务...
2025-10-02 19:55:27.761 [main] INFO  c.r.L.service.AgentService - 配置：混合模式=true, 基础提供者=ollama, 高级提供者=deepseek, 自动降级=true
2025-10-02 19:55:27.761 [main] INFO  c.r.L.service.AgentService - 初始化基础AI服务：ollama (qwen2:1.5b)
2025-10-02 19:55:27.768 [main] INFO  c.r.L.service.AgentService - 基础AI服务初始化成功：qwen2:1.5b
2025-10-02 19:55:27.768 [main] INFO  c.r.L.service.AgentService - 初始化高级AI服务：deepseek (deepseek-chat)
2025-10-02 19:55:27.795 [main] INFO  c.r.L.service.AgentService - 高级AI服务初始化成功：deepseek-chat
2025-10-02 19:55:27.795 [main] INFO  c.r.L.service.AgentService - === 混合AI法律顾问服务初始化完成 ===
2025-10-02 19:55:27.795 [main] INFO  c.r.L.service.AgentService - 基础服务状态：可用 (qwen2:1.5b)
2025-10-02 19:55:27.796 [main] INFO  c.r.L.service.AgentService - 高级服务状态：可用 (deepseek-chat)
2025-10-02 19:55:27.796 [main] INFO  c.r.L.service.AgentService - 自动降级：启用
2025-10-02 19:55:27.796 [main] INFO  c.r.L.service.AgentService - 混合AI架构完全就绪，智能路由已激活。
2025-10-02 19:55:27.796 [main] INFO  c.r.L.service.AgentService - ========================================
2025-10-02 19:55:27.804 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 聊天模型: qwen2:1.5b
2025-10-02 19:55:27.822 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 初始化法律查询路由器...
2025-10-02 19:55:27.822 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 法律查询路由器初始化完成，配置 6 个检索器
2025-10-02 19:55:27.834 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 开始初始化 Advanced Legal RAG 服务...
2025-10-02 19:55:27.835 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG 检索增强器...
2025-10-02 19:55:27.837 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 检索增强器构建完成
2025-10-02 19:55:27.837 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG AI 服务...
2025-10-02 19:55:27.839 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG AI 服务构建完成
2025-10-02 19:55:27.839 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced Legal RAG 服务初始化成功
2025-10-02 19:55:28.538 [main] INFO  c.r.L.service.EtlService - ETL服务初始化完成 - chunk大小: 0, 重叠: 0, 最小块: 0
2025-10-02 19:55:28.610 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化基础聊天客户端，使用Ollama Chat模型
2025-10-02 19:55:28.613 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化高级聊天客户端，使用DeepSeek Chat模型
2025-10-02 19:55:28.615 [main] INFO  c.r.L.config.AsyncConfig - 合同分析异步任务执行器初始化完成: 核心线程数=2, 最大线程数=4, 队列容量=50
2025-10-02 19:55:28.632 [main] INFO  c.r.L.config.AsyncConfig - 通用异步任务执行器初始化完成
2025-10-02 19:55:28.662 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建默认聊天记忆，使用Ollama聊天记忆
2025-10-02 19:55:28.837 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-10-02 19:55:28.879 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-10-02 19:55:29.687 [main] WARN  o.s.b.a.t.ThymeleafAutoConfiguration$DefaultTemplateResolverConfiguration - Cannot find template location: classpath:/templates/ (please add some templates, check your Thymeleaf configuration, or set spring.thymeleaf.check-template-location=false)
2025-10-02 19:55:30.695 [main] INFO  c.r.L.LegalAssistantApplication - Started LegalAssistantApplication in 8.945 seconds (process running for 9.272)
2025-10-02 19:55:30.699 [main] INFO  c.r.L.config.StartupIndexer - 检查是否需要索引法律文档...
2025-10-02 19:55:30.701 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 发现 6 个法律文档，检查是否需要索引...
2025-10-02 19:55:30.804 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 所有法律文档都已被索引，跳过自动索引
2025-10-02 19:55:42.252 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cc2b0b31, method=GET, uri=/api/doc.html, status=200, duration=12ms
2025-10-02 19:55:42.300 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=62884e5b, method=GET, uri=/api/webjars/css/app.1824bac3.css, status=200, duration=8ms
2025-10-02 19:55:42.304 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1a33fe11, method=GET, uri=/api/webjars/css/chunk-vendors.f24a310a.css, status=200, duration=5ms
2025-10-02 19:55:42.307 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0bfbfea7, method=GET, uri=/api/webjars/js/app.c31badf5.js, status=200, duration=6ms
2025-10-02 19:55:42.321 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c9352562, method=GET, uri=/api/webjars/js/chunk-vendors.d51cf6f8.js, status=200, duration=20ms
2025-10-02 19:55:42.414 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cbe25f9b, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=2ms
2025-10-02 19:55:42.415 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=bbae0010, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=3ms
2025-10-02 19:55:42.416 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e9205328, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=4ms
2025-10-02 19:55:42.417 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c97aa425, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=3ms
2025-10-02 19:55:42.419 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=aabd7919, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=5ms
2025-10-02 19:55:42.427 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c5d95c8f, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=3ms
2025-10-02 19:55:42.427 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c493b2e7, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=3ms
2025-10-02 19:55:42.431 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=11771737, method=GET, uri=/api/webjars/js/chunk-2d0da532.591ad7fc.js, status=200, duration=3ms
2025-10-02 19:55:42.434 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=671d50a3, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=5ms
2025-10-02 19:55:42.436 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=681d7ae7, method=GET, uri=/api/webjars/js/chunk-260d712a.390177fe.js, status=200, duration=14ms
2025-10-02 19:55:42.440 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0163896a, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=6ms
2025-10-02 19:55:42.443 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fea740b4, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=2ms
2025-10-02 19:55:42.443 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1c23bacf, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=2ms
2025-10-02 19:55:42.448 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c1030005, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=3ms
2025-10-02 19:55:42.452 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ceee53f9, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=5ms
2025-10-02 19:55:42.453 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e0d3dd16, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=8ms
2025-10-02 19:55:42.628 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1bba10a7, method=GET, uri=/api/v3/api-docs/swagger-config, status=200, duration=29ms
2025-10-02 19:55:42.990 [http-nio-8080-exec-4] INFO  o.s.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 335 ms
2025-10-02 19:55:43.011 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f6b981df, method=GET, uri=/api/v3/api-docs, status=200, duration=367ms
2025-10-02 19:55:43.088 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d7eced49, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=2ms
2025-10-02 19:55:43.088 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3ce50e00, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=2ms
2025-10-02 19:55:43.089 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=095550b5, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=2ms
2025-10-02 19:55:43.089 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=02640f46, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=3ms
2025-10-02 19:55:43.089 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f0ee1a85, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=3ms
2025-10-02 19:55:43.092 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d627edc9, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=4ms
2025-10-02 19:55:43.129 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=057903e3, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=2ms
2025-10-02 19:55:43.129 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=84467312, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=2ms
2025-10-02 19:55:43.130 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d965d779, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=3ms
2025-10-02 19:55:48.403 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5148ac11, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=3ms
2025-10-02 19:55:48.403 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=29d48d0b, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=3ms
2025-10-02 19:55:48.404 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b4fe02d1, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=4ms
2025-10-02 19:55:49.332 [http-nio-8080-exec-1] INFO  c.r.L.c.VectorDatabaseManagementController - 管理员请求向量数据库统计信息
2025-10-02 19:55:49.402 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=23527768, method=GET, uri=/api/admin/vector-db/stats, status=200, duration=92ms
2025-10-02 19:55:49.431 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=510027c9, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=7ms
2025-10-02 19:55:58.530 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ee020399, method=GET, uri=/api/admin/vector-db/health, status=200, duration=7ms
2025-10-02 19:56:04.169 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1ff5d62e, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=2ms
2025-10-02 19:56:14.730 [http-nio-8080-exec-8] ERROR c.r.L.c.ContractReviewController - 文件上传失败
java.lang.IllegalArgumentException: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:102)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.uploadContract(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-02 19:56:14.739 [http-nio-8080-exec-8] ERROR c.r.L.e.GlobalExceptionHandler - 运行时异常
java.lang.RuntimeException: 文件上传失败: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:133)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.uploadContract(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.IllegalArgumentException: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:102)
	... 152 common frames omitted
2025-10-02 19:56:14.749 [http-nio-8080-exec-8] ERROR c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f6b75fb1, method=POST, uri=/api/api/contracts/upload, status=500, duration=46ms
2025-10-02 19:56:40.059 [http-nio-8080-exec-7] INFO  c.r.L.c.ContractReviewController - 开始异步合同分析，审查ID: 2
2025-10-02 19:56:40.065 [http-nio-8080-exec-7] INFO  o.s.s.a.AnnotationAsyncExecutionInterceptor - More than one TaskExecutor bean found within the context, and none is named 'taskExecutor'. Mark one of them as primary or name it 'taskExecutor' (possibly as an alias) in order to use it for async processing: [contractAnalysisTaskExecutor, generalTaskExecutor]
2025-10-02 19:56:40.068 [SimpleAsyncTaskExecutor-1] INFO  c.r.L.service.ContractReviewService - 开始异步分析合同，审查ID: 2
2025-10-02 19:56:40.077 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1a9e2b0c, method=POST, uri=/api/api/contracts/2/analyze-async, status=200, duration=20ms
2025-10-02 19:56:40.174 [SimpleAsyncTaskExecutor-1] INFO  c.r.LegalAssistant.service.AiService - 进行结构化合同风险分析，内容长度: 7321
2025-10-02 19:57:52.281 [SimpleAsyncTaskExecutor-1] INFO  c.r.LegalAssistant.service.AiService - 分析合同风险，内容长度: 7321
2025-10-02 19:57:55.434 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=96c35a6a, method=GET, uri=/api/api/contracts/5, status=200, duration=33ms
2025-10-02 19:58:04.394 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=acb9bac7, method=GET, uri=/api/api/contracts/2, status=200, duration=13ms
2025-10-02 19:58:12.914 [http-nio-8080-exec-3] ERROR c.r.L.e.GlobalExceptionHandler - 运行时异常
java.lang.NullPointerException: null
	at java.base/java.util.Objects.requireNonNull(Objects.java:233)
	at java.base/java.util.ImmutableCollections$MapN.<init>(ImmutableCollections.java:1193)
	at java.base/java.util.Map.of(Map.java:1518)
	at com.river.LegalAssistant.controller.ContractReviewController.getReviewSummary(ContractReviewController.java:316)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.getReviewSummary(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-02 19:58:12.920 [http-nio-8080-exec-3] ERROR c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3e002880, method=GET, uri=/api/api/contracts/2/summary, status=500, duration=13ms
2025-10-02 19:58:17.329 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=73d79937, method=GET, uri=/api/api/contracts/5/summary, status=200, duration=7ms
2025-10-02 19:58:28.446 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=05475789, method=GET, uri=/api/api/contracts/statistics/user/2, status=200, duration=7ms
2025-10-02 19:58:31.101 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=51379ad2, method=GET, uri=/api/api/contracts/statistics/user/1, status=200, duration=4ms
2025-10-02 19:58:34.039 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=300971a3, method=GET, uri=/api/api/contracts/statistics/risk-levels, status=200, duration=17ms
2025-10-02 19:58:39.999 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=6528f108, method=GET, uri=/api/api/contracts/my-statistics, status=200, duration=8ms
2025-10-02 19:58:42.656 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=07318609, method=GET, uri=/api/api/contracts/my-reviews, status=200, duration=50ms
2025-10-02 19:58:56.720 [SimpleAsyncTaskExecutor-1] INFO  c.r.LegalAssistant.service.AiService - 合同风险分析完成，分析结果长度: 2871 字符
2025-10-02 19:58:56.721 [SimpleAsyncTaskExecutor-1] INFO  c.r.LegalAssistant.service.AiService - 结构化风险分析完成，识别出 10 个风险维度
2025-10-02 19:58:56.782 [SimpleAsyncTaskExecutor-1] INFO  c.r.L.service.ContractReviewService - 合同异步分析完成，风险等级: MEDIUM
2025-10-02 19:58:56.787 [http-nio-8080-exec-1] INFO  c.r.L.service.ContractReviewService - SSE连接完成: reviewId=2
2025-10-02 19:58:58.660 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=065337d8, method=GET, uri=/api/api/contracts/admin/all, status=200, duration=29ms
2025-10-02 19:59:35.408 [http-nio-8080-exec-10] ERROR c.r.L.c.ContractReviewController - 文件上传失败
java.lang.IllegalArgumentException: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:102)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.uploadContract(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-02 19:59:35.412 [http-nio-8080-exec-10] ERROR c.r.L.e.GlobalExceptionHandler - 运行时异常
java.lang.RuntimeException: 文件上传失败: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:133)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.uploadContract(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.IllegalArgumentException: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:102)
	... 152 common frames omitted
2025-10-02 19:59:35.417 [http-nio-8080-exec-10] ERROR c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2ff7af5d, method=POST, uri=/api/api/contracts/upload, status=500, duration=13ms
2025-10-02 20:01:04.081 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d92edb8b, method=GET, uri=/api/users/1, status=200, duration=6ms
2025-10-02 20:01:06.179 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=64f8913c, method=GET, uri=/api/users/2, status=200, duration=6ms
2025-10-02 20:01:16.206 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e3ac1797, method=GET, uri=/api/users/1, status=200, duration=4ms
2025-10-02 20:01:31.809 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=905bfcf0, method=GET, uri=/api/users/2, status=200, duration=5ms
2025-10-02 20:01:46.882 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=50e6b2c3, method=PUT, uri=/api/users/2, status=200, duration=31ms
2025-10-02 20:01:50.333 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fabd1af7, method=GET, uri=/api/users/2, status=200, duration=5ms
2025-10-02 20:02:52.912 [http-nio-8080-exec-10] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=65079bf7, method=POST, uri=/api/users/register, status=400, duration=18ms
2025-10-02 20:03:03.499 [http-nio-8080-exec-3] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3c9970dc, method=POST, uri=/api/users/register, status=400, duration=14ms
2025-10-02 20:03:07.833 [http-nio-8080-exec-2] INFO  c.r.L.service.UserService - 创建新用户: newuser1234
2025-10-02 20:03:07.843 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ce40ee54, method=POST, uri=/api/users/register, status=200, duration=91ms
2025-10-02 20:03:19.292 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=949c376c, method=GET, uri=/api/users/4, status=200, duration=5ms
2025-10-02 20:03:41.884 [http-nio-8080-exec-7] INFO  c.r.L.service.UserService - 用户 newuser1234 修改密码成功
2025-10-02 20:03:41.898 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=42f27025, method=POST, uri=/api/users/4/change-password, status=200, duration=162ms
2025-10-02 20:03:49.993 [http-nio-8080-exec-9] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=071cce48, method=GET, uri=/api/users/username/%E7%8E%8B%E4%BA%94, status=404, duration=4ms
2025-10-02 20:04:10.772 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=13ebf0e4, method=GET, uri=/api/users/username/admin, status=200, duration=5ms
2025-10-02 20:04:23.689 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cd30a50c, method=GET, uri=/api/users/username/newuser1234, status=200, duration=4ms
2025-10-02 20:04:27.823 [http-nio-8080-exec-5] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=950f615c, method=GET, uri=/api/users/email/admin@example.com, status=404, duration=5ms
2025-10-02 20:04:45.859 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=18be5344, method=GET, uri=/api/users/email/newuse1r@example.com, status=200, duration=5ms
2025-10-02 20:04:49.929 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a29bdc50, method=GET, uri=/api/health, status=200, duration=1ms
2025-10-02 20:04:52.755 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=8da0f661, method=GET, uri=/api/health/info, status=200, duration=1ms
2025-10-02 20:06:08.329 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7cb293ca, method=GET, uri=/api/health/detailed, status=200, duration=4472ms
2025-10-02 20:06:13.678 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ffd5253f, method=GET, uri=/api/health/deepseek, status=200, duration=2804ms
2025-10-02 20:06:30.504 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=9fa100f6, method=GET, uri=/api/health/ai/test, status=200, duration=14137ms
2025-10-02 20:08:12.501 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0029b00d, method=GET, uri=/api/health/agent, status=200, duration=0ms
2025-10-02 20:10:50.503 [http-nio-8080-exec-10] INFO  c.r.L.service.DeepSeekService - DeepSeek推理完成 - 问题长度: 76, 推理步骤长度: 1524, 答案长度: 1937
2025-10-02 20:10:50.504 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=68b2b440, method=POST, uri=/api/ai/deepseek/reasoning, status=200, duration=82406ms
2025-10-02 20:11:29.647 [http-nio-8080-exec-2] INFO  c.r.LegalAssistant.service.AiService - 处理本地知识库聊天请求: 你好，请介绍一下民法典。
2025-10-02 20:11:29.647 [http-nio-8080-exec-2] INFO  c.r.L.service.RAGService - 执行RAG流程,问题: 你好，请介绍一下民法典。, 最大结果数: 15
2025-10-02 20:11:29.647 [http-nio-8080-exec-2] INFO  c.r.L.service.VectorStoreService - 搜索相似文档,查询: 你好，请介绍一下民法典。, 最大结果数: 15
2025-10-02 20:11:29.911 [http-nio-8080-exec-2] INFO  c.r.L.service.VectorStoreService - Spring AI向量存储结果不足(0个),尝试LangChain4j向量存储作为补充
2025-10-02 20:11:30.173 [http-nio-8080-exec-2] INFO  c.r.L.service.VectorStoreService - 从LangChain4j向量存储补充 14 个结果
2025-10-02 20:11:30.174 [http-nio-8080-exec-2] INFO  c.r.L.service.VectorStoreService - 最终返回 14 个相似文档
2025-10-02 20:11:51.447 [http-nio-8080-exec-2] INFO  c.r.L.service.RAGService - RAG流程完成,使用了 14 个文档片段
2025-10-02 20:11:51.448 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=eaf3a014, method=POST, uri=/api/ai/chat, status=200, duration=21804ms
2025-10-02 20:13:51.666 [http-nio-8080-exec-7] INFO  c.r.L.service.AgentService - 处理法律咨询请求: 你好，我是一名在职员工,当前公司压榨员工严重,经常加班,而且不给加班费,并且存在拖欠工资的情况,我作..., 会话ID: default
2025-10-02 20:13:51.689 [http-nio-8080-exec-7] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.deepseek.com/chat/completions
- headers: [Authorization: Beare...72], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "deepseek-chat",
  "messages" : [ {
    "role" : "user",
    "content" : "作为专业法律助手，请提供准确、详细的法律建议：你好，我是一名在职员工,当前公司压榨员工严重,经常加班,而且不给加班费,并且存在拖欠工资的情况,我作为受害者该怎么维权?"
  } ],
  "temperature" : 0.3,
  "stream" : false,
  "max_tokens" : 4096
}

2025-10-02 20:14:40.940 [http-nio-8080-exec-7] INFO  c.r.L.service.AgentService - 使用DeepSeek AI Agent处理法律咨询，会话: default
2025-10-02 20:14:40.941 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4fb091d6, method=POST, uri=/api/ai/chat/legal, status=200, duration=52237ms
2025-10-02 20:15:33.943 [http-nio-8080-exec-9] INFO  c.r.L.controller.AiController - 开始流式法律咨询，问题: 你好，请介绍一下民法典。
2025-10-02 20:15:33.946 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=96bc6e1d, method=POST, uri=/api/ai/chat/legal/stream, status=200, duration=4ms
2025-10-02 20:15:33.946 [ForkJoinPool.commonPool-worker-6] INFO  c.r.L.service.AgentService - 开始流式法律咨询处理: 你好，请介绍一下民法典。
2025-10-02 20:15:33.947 [ForkJoinPool.commonPool-worker-6] INFO  c.r.L.service.AgentService - 使用高级流式模型进行推送
2025-10-02 20:15:33.954 [ForkJoinPool.commonPool-worker-6] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.deepseek.com/chat/completions
- headers: [Authorization: Beare...72], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "deepseek-chat",
  "messages" : [ {
    "role" : "user",
    "content" : "作为专业法律助手，请提供准确、详细的法律建议：你好，请介绍一下民法典。"
  } ],
  "temperature" : 0.3,
  "stream" : true,
  "stream_options" : {
    "include_usage" : true
  },
  "max_tokens" : 4096
}

2025-10-02 20:16:42.836 [ForkJoinPool.commonPool-worker-6] INFO  c.r.L.service.AgentService - 流式响应完成，总长度: 3247
2025-10-02 20:16:42.837 [http-nio-8080-exec-4] INFO  c.r.L.controller.AiController - 流式法律咨询完成
2025-10-02 20:17:07.764 [http-nio-8080-exec-6] INFO  c.r.L.controller.AiController - Advanced RAG 法律咨询请求: 合同违约后的损害赔偿如何计算？, 会话: default
2025-10-02 20:17:07.764 [http-nio-8080-exec-6] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG 处理法律咨询: 合同违约后的损害赔偿如何计算？, 会话: default
2025-10-02 20:17:07.775 [http-nio-8080-exec-6] INFO  c.r.L.s.a.LegalQueryTransformer - 转换法律查询: 合同违约后的损害赔偿如何计算？
2025-10-02 20:17:10.971 [http-nio-8080-exec-6] INFO  c.r.L.s.a.LegalQueryTransformer - 查询转换完成，原始1个查询扩展为6个查询
2025-10-02 20:17:10.973 [pool-4-thread-1] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 合同违约后的损害赔偿如何计算？
2025-10-02 20:17:10.973 [pool-4-thread-3] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 合同违约后，损害赔偿的计算方法是什么？
2025-10-02 20:17:10.973 [pool-4-thread-4] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 在合同违约情况下，如何确定赔偿金额？
2025-10-02 20:17:10.974 [pool-4-thread-5] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 什么是损害赔偿的标准和范围？
2025-10-02 20:17:10.974 [pool-4-thread-2] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 合同协议违约责任后的损害损害赔偿如何计算？
2025-10-02 20:17:10.974 [pool-4-thread-6] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 违约 损害 赔偿 合同
2025-10-02 20:17:11.140 [pool-4-thread-1] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:17:11.141 [pool-4-thread-7] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约后的损害赔偿如何计算？
2025-10-02 20:17:11.141 [pool-4-thread-8] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约后的损害赔偿如何计算？
2025-10-02 20:17:11.154 [pool-4-thread-4] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:17:11.154 [pool-4-thread-1] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 在合同违约情况下，如何确定赔偿金额？
2025-10-02 20:17:11.155 [pool-4-thread-9] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 在合同违约情况下，如何确定赔偿金额？
2025-10-02 20:17:11.242 [pool-4-thread-3] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:17:11.242 [pool-4-thread-6] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 CONTRACT_ANALYSIS 选择了 2 个检索器
2025-10-02 20:17:11.243 [pool-4-thread-4] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约后，损害赔偿的计算方法是什么？
2025-10-02 20:17:11.243 [pool-4-thread-3] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 违约 损害 赔偿 合同
2025-10-02 20:17:11.243 [pool-4-thread-10] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约后，损害赔偿的计算方法是什么？
2025-10-02 20:17:11.243 [pool-4-thread-11] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 违约 损害 赔偿 合同
2025-10-02 20:17:11.331 [pool-4-thread-2] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:17:11.331 [pool-4-thread-6] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同协议违约责任后的损害损害赔偿如何计算？
2025-10-02 20:17:11.331 [pool-4-thread-12] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同协议违约责任后的损害损害赔偿如何计算？
2025-10-02 20:17:11.346 [pool-4-thread-5] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:17:11.346 [pool-4-thread-2] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是损害赔偿的标准和范围？
2025-10-02 20:17:11.346 [pool-4-thread-13] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是损害赔偿的标准和范围？
2025-10-02 20:17:12.243 [pool-4-thread-8] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.243 [pool-4-thread-7] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.252 [pool-4-thread-9] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.272 [pool-4-thread-11] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.293 [pool-4-thread-12] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.300 [pool-4-thread-6] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.310 [pool-4-thread-2] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.326 [pool-4-thread-1] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.328 [pool-4-thread-3] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.344 [pool-4-thread-4] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.348 [pool-4-thread-10] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.352 [pool-4-thread-13] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:17:12.354 [http-nio-8080-exec-6] INFO  c.r.L.s.a.LegalContentAggregator - 开始聚合法律内容，共 6 个查询，总内容数: 120
2025-10-02 20:17:12.425 [http-nio-8080-exec-6] INFO  c.r.L.s.a.LegalContentAggregator - 内容聚合完成，返回 10 个结果
2025-10-02 20:17:12.425 [http-nio-8080-exec-6] INFO  c.r.L.s.a.LegalContentInjector - 注入法律内容到用户消息，内容数量: 10
2025-10-02 20:17:12.430 [http-nio-8080-exec-6] INFO  c.r.L.s.a.LegalContentInjector - 法律内容注入完成，增强消息长度: 946
2025-10-02 20:17:14.776 [http-nio-8080-exec-6] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG 回答生成完成，耗时: 7012ms, 使用源: 10
2025-10-02 20:17:14.778 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2ab21c36, method=POST, uri=/api/ai/advanced-rag/chat, status=200, duration=7016ms
2025-10-02 20:17:32.408 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=db79533a, method=GET, uri=/api/ai/advanced-rag/status, status=200, duration=2ms
2025-10-02 20:17:45.574 [http-nio-8080-exec-5] INFO  c.r.L.s.a.AdvancedLegalRagService - 重置会话记忆: default
2025-10-02 20:17:45.576 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=bab6fb74, method=POST, uri=/api/ai/advanced-rag/reset-session, status=200, duration=2ms
2025-10-02 20:17:54.089 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=821d082a, method=GET, uri=/api/ai/advanced-rag/session-stats, status=200, duration=2ms
2025-10-02 20:18:31.338 [http-nio-8080-exec-3] INFO  c.r.L.c.UnifiedChatController - 收到统一聊天请求: message=什么是合同违约？, modelType=BASIC, conversationId=1, useKnowledgeBase=true
2025-10-02 20:18:31.344 [http-nio-8080-exec-3] INFO  c.r.LegalAssistant.service.AiService - 处理带聊天记忆的本地知识库聊天: conversationId=1, modelType=OLLAMA, question=什么是合同违约？
2025-10-02 20:18:31.347 [http-nio-8080-exec-3] INFO  c.r.L.service.RAGService - 使用自定义ChatClient执行RAG流程
2025-10-02 20:18:31.348 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - 搜索相似文档,查询: 什么是合同违约？, 最大结果数: 15
2025-10-02 20:18:31.458 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - Spring AI向量存储结果不足(4个),尝试LangChain4j向量存储作为补充
2025-10-02 20:18:31.602 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - 从LangChain4j向量存储补充 11 个结果
2025-10-02 20:18:31.602 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - 最终返回 15 个相似文档
2025-10-02 20:18:45.456 [http-nio-8080-exec-3] INFO  c.r.L.service.RAGService - RAG流程完成(自定义Client),使用了 15 个文档片段
2025-10-02 20:18:45.457 [http-nio-8080-exec-3] INFO  c.r.LegalAssistant.service.AiService - 带聊天记忆的本地知识库聊天响应生成成功: conversationId=1, modelType=OLLAMA, 使用了 15 个文档片段
2025-10-02 20:18:45.457 [http-nio-8080-exec-3] INFO  c.r.L.c.UnifiedChatController - 统一聊天请求处理完成，耗时: 14119 ms
2025-10-02 20:18:45.459 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f97a617c, method=POST, uri=/api/api/v1/chat, status=200, duration=14124ms
2025-10-02 20:19:30.494 [http-nio-8080-exec-2] INFO  c.r.L.c.UnifiedChatController - 收到统一聊天请求: message=什么是合同违约？, modelType=ADVANCED, conversationId=1, useKnowledgeBase=true
2025-10-02 20:19:33.584 [http-nio-8080-exec-2] INFO  c.r.L.service.AgentService - 处理法律咨询请求: 什么是合同违约？, 会话ID: default
2025-10-02 20:19:33.585 [http-nio-8080-exec-2] INFO  d.l.h.client.log.LoggingHttpClient - HTTP request:
- method: POST
- url: https://api.deepseek.com/chat/completions
- headers: [Authorization: Beare...72], [User-Agent: langchain4j-openai], [Content-Type: application/json]
- body: {
  "model" : "deepseek-chat",
  "messages" : [ {
    "role" : "user",
    "content" : "作为专业法律助手，请提供准确、详细的法律建议：什么是合同违约？"
  } ],
  "temperature" : 0.3,
  "stream" : false,
  "max_tokens" : 4096
}

2025-10-02 20:20:28.472 [http-nio-8080-exec-2] INFO  c.r.L.service.AgentService - 使用DeepSeek AI Agent处理法律咨询，会话: default
2025-10-02 20:20:28.472 [http-nio-8080-exec-2] INFO  c.r.L.c.UnifiedChatController - 统一聊天请求处理完成，耗时: 57978 ms
2025-10-02 20:20:28.474 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4a52fbad, method=POST, uri=/api/api/v1/chat, status=200, duration=57981ms
2025-10-02 20:21:01.924 [http-nio-8080-exec-8] INFO  c.r.L.c.UnifiedChatController - 收到统一聊天请求: message=什么是合同违约？, modelType=ADVANCED_RAG, conversationId=1, useKnowledgeBase=true
2025-10-02 20:21:01.925 [http-nio-8080-exec-8] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG 处理法律咨询: 什么是合同违约？, 会话: 1
2025-10-02 20:21:01.926 [http-nio-8080-exec-8] INFO  c.r.L.s.a.LegalQueryTransformer - 转换法律查询: 什么是合同违约？
2025-10-02 20:21:03.706 [http-nio-8080-exec-8] INFO  c.r.L.s.a.LegalQueryTransformer - 查询转换完成，原始1个查询扩展为6个查询
2025-10-02 20:21:03.707 [pool-4-thread-14] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 什么是合同违约？
2025-10-02 20:21:03.707 [pool-4-thread-16] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 合同违约的定义是什么？
2025-10-02 20:21:03.708 [pool-4-thread-17] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 合同违约的责任承担方式有哪些？
2025-10-02 20:21:03.708 [pool-4-thread-15] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 什么是合同协议违约责任？
2025-10-02 20:21:03.708 [pool-4-thread-18] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 什么是合同违约的证据收集和证明方法？
2025-10-02 20:21:03.708 [pool-4-thread-19] INFO  c.r.L.s.advanced.LegalQueryRouter - 路由法律查询: 违约 合同
2025-10-02 20:21:03.863 [pool-4-thread-14] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 CONTRACT_ANALYSIS 选择了 2 个检索器
2025-10-02 20:21:03.863 [pool-4-thread-20] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是合同违约？
2025-10-02 20:21:03.864 [pool-4-thread-21] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是合同违约？
2025-10-02 20:21:03.883 [pool-4-thread-16] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:21:03.883 [pool-4-thread-14] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约的定义是什么？
2025-10-02 20:21:03.884 [pool-4-thread-22] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约的定义是什么？
2025-10-02 20:21:03.977 [pool-4-thread-21] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:03.990 [pool-4-thread-15] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 CONTRACT_ANALYSIS 选择了 2 个检索器
2025-10-02 20:21:03.990 [pool-4-thread-21] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是合同协议违约责任？
2025-10-02 20:21:03.991 [pool-4-thread-16] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是合同协议违约责任？
2025-10-02 20:21:04.002 [pool-4-thread-20] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.021 [pool-4-thread-22] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.042 [pool-4-thread-14] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.062 [pool-4-thread-17] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:21:04.063 [pool-4-thread-22] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约的责任承担方式有哪些？
2025-10-02 20:21:04.063 [pool-4-thread-14] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 合同违约的责任承担方式有哪些？
2025-10-02 20:21:04.106 [pool-4-thread-21] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.128 [pool-4-thread-16] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.144 [pool-4-thread-18] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 LAW_INTERPRETATION 选择了 2 个检索器
2025-10-02 20:21:04.144 [pool-4-thread-16] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是合同违约的证据收集和证明方法？
2025-10-02 20:21:04.144 [pool-4-thread-21] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 什么是合同违约的证据收集和证明方法？
2025-10-02 20:21:04.163 [pool-4-thread-19] INFO  c.r.L.s.advanced.LegalQueryRouter - 为查询类型 CONTRACT_ANALYSIS 选择了 2 个检索器
2025-10-02 20:21:04.164 [pool-4-thread-18] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 违约 合同
2025-10-02 20:21:04.164 [pool-4-thread-17] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索法律内容: 违约 合同
2025-10-02 20:21:04.178 [pool-4-thread-14] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.256 [pool-4-thread-16] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.268 [pool-4-thread-21] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.290 [pool-4-thread-18] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.309 [pool-4-thread-17] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.311 [pool-4-thread-22] INFO  c.r.L.s.a.LegalContentRetriever - 多源检索完成，返回 10 个结果
2025-10-02 20:21:04.312 [http-nio-8080-exec-8] INFO  c.r.L.s.a.LegalContentAggregator - 开始聚合法律内容，共 6 个查询，总内容数: 120
2025-10-02 20:21:04.402 [http-nio-8080-exec-8] INFO  c.r.L.s.a.LegalContentAggregator - 内容聚合完成，返回 10 个结果
2025-10-02 20:21:04.403 [http-nio-8080-exec-8] INFO  c.r.L.s.a.LegalContentInjector - 注入法律内容到用户消息，内容数量: 10
2025-10-02 20:21:04.408 [http-nio-8080-exec-8] INFO  c.r.L.s.a.LegalContentInjector - 法律内容注入完成，增强消息长度: 966
2025-10-02 20:21:06.900 [http-nio-8080-exec-8] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG 回答生成完成，耗时: 4974ms, 使用源: 10
2025-10-02 20:21:06.907 [http-nio-8080-exec-8] INFO  c.r.L.c.UnifiedChatController - 统一聊天请求处理完成，耗时: 4983 ms
2025-10-02 20:21:06.908 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f203b548, method=POST, uri=/api/api/v1/chat, status=200, duration=4985ms
2025-10-02 20:21:25.752 [http-nio-8080-exec-7] INFO  c.r.L.service.ChatMemoryService - 成功清除会话 1 的聊天记忆 (模型: ollama)
2025-10-02 20:21:25.752 [http-nio-8080-exec-7] INFO  c.r.L.service.ChatMemoryService - 成功清除会话 1 的聊天记忆 (模型: deepseek)
2025-10-02 20:21:25.752 [http-nio-8080-exec-7] INFO  c.r.L.service.ChatMemoryService - 完成清除所有模型的会话 1 聊天记忆
2025-10-02 20:21:25.753 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=075d66e8, method=DELETE, uri=/api/api/v1/chat/session/1, status=200, duration=2ms
2025-10-02 20:21:32.615 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7197ef41, method=GET, uri=/api/api/v1/chat/stats, status=200, duration=2945ms
2025-10-02 20:21:47.640 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d0a2e5f6, method=GET, uri=/api/knowledge-base/documents/9, status=200, duration=9ms
2025-10-02 20:21:53.792 [http-nio-8080-exec-1] ERROR c.r.L.e.GlobalExceptionHandler - 未处理的异常
org.springframework.web.HttpMediaTypeNotSupportedException: Content-Type 'application/x-www-form-urlencoded;charset=UTF-8' is not supported
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodArgumentResolver.readWithMessageConverters(AbstractMessageConverterMethodArgumentResolver.java:213)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.readWithMessageConverters(RequestResponseBodyMethodProcessor.java:161)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:135)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:224)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:178)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:925)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:593)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-02 20:21:53.798 [http-nio-8080-exec-1] ERROR c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0ed64e74, method=PUT, uri=/api/knowledge-base/documents/9, status=500, duration=9ms
2025-10-02 20:22:24.657 [http-nio-8080-exec-10] INFO  c.r.L.c.KnowledgeBaseController - 管理员请求重建知识库索引
2025-10-02 20:22:24.657 [http-nio-8080-exec-10] INFO  c.r.L.service.KnowledgeBaseService - 开始重建知识库索引...
2025-10-02 20:22:24.658 [ForkJoinPool.commonPool-worker-8] WARN  c.r.L.service.KnowledgeBaseService - 清空向量存储功能需要根据具体的VectorStore实现来完成
2025-10-02 20:22:24.658 [ForkJoinPool.commonPool-worker-8] INFO  c.r.L.service.KnowledgeBaseService - 知识库索引重建完成
2025-10-02 20:22:24.658 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=f23a6980, method=POST, uri=/api/knowledge-base/reindex, status=200, duration=2ms
2025-10-02 20:22:45.307 [http-nio-8080-exec-3] INFO  c.r.L.c.KnowledgeBaseController - 统一文档索引请求 - 文件路径: null, 目录路径: null, 递归: false, 分类: 法律文档
2025-10-02 20:22:45.307 [http-nio-8080-exec-3] INFO  c.r.L.c.KnowledgeBaseController - 未提供目录参数，使用默认目录: [uploads/law, uploads/contracts]
2025-10-02 20:22:45.307 [http-nio-8080-exec-3] INFO  c.r.L.c.KnowledgeBaseController - 执行批量目录索引: [uploads/law, uploads/contracts], 递归: false
2025-10-02 20:22:45.307 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始批量索引目录: uploads/law, 递归: false
2025-10-02 20:22:45.308 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 发现 6 个文档待索引
2025-10-02 20:22:45.308 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\law\刑法.pdf
2025-10-02 20:22:45.311 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档已存在于数据库中，跳过索引: F:\LegalAssistant\uploads\law\刑法.pdf
2025-10-02 20:22:45.311 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\law\劳动法.pdf
2025-10-02 20:22:45.313 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档已存在于数据库中，跳过索引: F:\LegalAssistant\uploads\law\劳动法.pdf
2025-10-02 20:22:45.313 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\law\宪法.pdf
2025-10-02 20:22:45.315 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档已存在于数据库中，跳过索引: F:\LegalAssistant\uploads\law\宪法.pdf
2025-10-02 20:22:45.315 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\law\民事诉讼法.pdf
2025-10-02 20:22:45.316 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档已存在于数据库中，跳过索引: F:\LegalAssistant\uploads\law\民事诉讼法.pdf
2025-10-02 20:22:45.317 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\law\民法典.pdf
2025-10-02 20:22:45.319 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档已存在于数据库中，跳过索引: F:\LegalAssistant\uploads\law\民法典.pdf
2025-10-02 20:22:45.320 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\law\环境保护法.pdf
2025-10-02 20:22:45.321 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档已存在于数据库中，跳过索引: F:\LegalAssistant\uploads\law\环境保护法.pdf
2025-10-02 20:22:45.321 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 批量索引完成: 总计 6 个文档, 成功 6 个, 生成 0 个片段, 耗时 13ms
2025-10-02 20:22:45.321 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始批量索引目录: uploads/contracts, 递归: false
2025-10-02 20:22:45.322 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 发现 3 个文档待索引
2025-10-02 20:22:45.322 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\contracts\0b0e8e2a4601b55fa602df155d13f17a9bbcc9dc8b7199b0646500369166ec4b_《危险化学品生产经营企业自建网站销售合同（示范文本）》.docx
2025-10-02 20:22:46.805 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档索引完成: F:\LegalAssistant\uploads\contracts\0b0e8e2a4601b55fa602df155d13f17a9bbcc9dc8b7199b0646500369166ec4b_《危险化学品生产经营企业自建网站销售合同（示范文本）》.docx, 片段数: 7, 耗时: 1483ms
2025-10-02 20:22:46.806 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\contracts\454780187d36c4fce24a42ca24a270b4505e40a957c5e0093c3854211b8f36fd_广州市既有住宅加装电梯委托管理合同.docx
2025-10-02 20:22:47.261 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档索引完成: F:\LegalAssistant\uploads\contracts\454780187d36c4fce24a42ca24a270b4505e40a957c5e0093c3854211b8f36fd_广州市既有住宅加装电梯委托管理合同.docx, 片段数: 4, 耗时: 455ms
2025-10-02 20:22:47.261 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 开始索引文档: F:\LegalAssistant\uploads\contracts\573fde99c3197ab6b24a557b15e4dac514eae53250c2754db7097329e68420f3_上海市拍卖业委托拍卖合同示范文本.docx
2025-10-02 20:22:47.737 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 文档索引完成: F:\LegalAssistant\uploads\contracts\573fde99c3197ab6b24a557b15e4dac514eae53250c2754db7097329e68420f3_上海市拍卖业委托拍卖合同示范文本.docx, 片段数: 4, 耗时: 476ms
2025-10-02 20:22:47.738 [http-nio-8080-exec-3] INFO  c.r.L.s.DocumentIndexingService - 批量索引完成: 总计 3 个文档, 成功 3 个, 生成 15 个片段, 耗时 2416ms
2025-10-02 20:22:47.742 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e65f40a4, method=POST, uri=/api/knowledge-base/index/documents, status=200, duration=2437ms
2025-10-02 20:23:42.718 [http-nio-8080-exec-2] INFO  c.r.L.service.KnowledgeBaseService - 从数据库获取文档列表: 页码=0, 每页=20, 分类=null, 总数=9
2025-10-02 20:23:42.719 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=116c9dbd, method=GET, uri=/api/knowledge-base/documents, status=200, duration=19ms
2025-10-02 20:24:17.948 [http-nio-8080-exec-8] INFO  c.r.L.c.KnowledgeBaseController - 管理员批量上传 2 个法律文档
2025-10-02 20:24:17.949 [http-nio-8080-exec-8] INFO  c.r.L.service.KnowledgeBaseService - 开始批量上传 2 个文档
2025-10-02 20:24:17.974 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.KnowledgeBaseService - 开始上传文档到知识库 (使用EtlService): 拍卖法.pdf, 大小: 194898 bytes
2025-10-02 20:24:17.975 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.DocumentParserService - 开始解析文档: 拍卖法.pdf, 类型: pdf, 大小: 194898 bytes
2025-10-02 20:24:17.980 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.KnowledgeBaseService - 开始上传文档到知识库 (使用EtlService): 中华人民共和国社会保险法.pdf, 大小: 204661 bytes
2025-10-02 20:24:17.981 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.DocumentParserService - 开始解析文档: 中华人民共和国社会保险法.pdf, 类型: pdf, 大小: 204661 bytes
2025-10-02 20:24:18.395 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.DocumentParserService - 文档解析成功: 拍卖法.pdf, 内容长度: 5198 字符
2025-10-02 20:24:18.395 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.EtlService - 开始处理文本内容，长度: 5198 字符
2025-10-02 20:24:18.399 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.EtlService - 文本分块完成，生成 404 个文本块
2025-10-02 20:24:18.534 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.DocumentParserService - 文档解析成功: 中华人民共和国社会保险法.pdf, 内容长度: 10888 字符
2025-10-02 20:24:18.534 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.EtlService - 开始处理文本内容，长度: 10888 字符
2025-10-02 20:24:18.536 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.EtlService - 文本分块完成，生成 407 个文本块
2025-10-02 20:24:29.143 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.EtlService - 文本内容处理完成，404 个向量块已存储
2025-10-02 20:24:29.148 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.KnowledgeBaseService - 文档保存到数据库成功：拍卖法.pdf
2025-10-02 20:24:29.148 [ForkJoinPool.commonPool-worker-9] INFO  c.r.L.service.KnowledgeBaseService - 文档上传完成 (EtlService): 拍卖法.pdf, 文档ID: 81ddfb23f467a76f, 块数: 404
2025-10-02 20:24:30.410 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.EtlService - 文本内容处理完成，407 个向量块已存储
2025-10-02 20:24:30.416 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.KnowledgeBaseService - 文档保存到数据库成功：中华人民共和国社会保险法.pdf
2025-10-02 20:24:30.416 [ForkJoinPool.commonPool-worker-10] INFO  c.r.L.service.KnowledgeBaseService - 文档上传完成 (EtlService): 中华人民共和国社会保险法.pdf, 文档ID: 9aaa379973b04771, 块数: 407
2025-10-02 20:24:30.416 [http-nio-8080-exec-8] INFO  c.r.L.service.KnowledgeBaseService - 批量上传完成，成功: 2, 失败: 0
2025-10-02 20:24:30.418 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=06950d94, method=POST, uri=/api/knowledge-base/documents, status=200, duration=12481ms
2025-10-02 20:24:37.891 [http-nio-8080-exec-7] INFO  c.r.L.service.KnowledgeBaseService - 从数据库获取文档列表: 页码=0, 每页=20, 分类=null, 总数=11
2025-10-02 20:24:37.893 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b1dbdb89, method=GET, uri=/api/knowledge-base/documents, status=200, duration=10ms
2025-10-02 20:25:29.348 [http-nio-8080-exec-9] INFO  c.r.L.c.KnowledgeBaseController - 管理员删除单个文档: {15, 16}
2025-10-02 20:25:29.348 [http-nio-8080-exec-9] INFO  c.r.L.service.KnowledgeBaseService - 开始删除文档: {15, 16}
2025-10-02 20:25:29.349 [http-nio-8080-exec-9] WARN  c.r.L.service.KnowledgeBaseService - 文档不存在: {15, 16}
2025-10-02 20:25:29.349 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e96e56b6, method=DELETE, uri=/api/knowledge-base/documents, status=200, duration=3ms
2025-10-02 20:25:50.536 [http-nio-8080-exec-4] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=61bdb17f, method=DELETE, uri=/api/knowledge-base/documents, status=400, duration=1ms
2025-10-02 20:26:04.444 [http-nio-8080-exec-6] INFO  c.r.L.c.KnowledgeBaseController - 管理员批量删除 2 个文档
2025-10-02 20:26:04.445 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 开始批量删除 2 个文档
2025-10-02 20:26:04.445 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 开始删除文档: 15
2025-10-02 20:26:04.476 [http-nio-8080-exec-6] WARN  c.r.L.service.KnowledgeBaseService - 删除文档块功能需要根据具体的VectorStore实现来完成: uploads/拍卖法.pdf
2025-10-02 20:26:04.476 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 数据库文档删除成功: 拍卖法.pdf (ID: 15)
2025-10-02 20:26:04.477 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 开始删除文档: 16
2025-10-02 20:26:04.482 [http-nio-8080-exec-6] WARN  c.r.L.service.KnowledgeBaseService - 删除文档块功能需要根据具体的VectorStore实现来完成: uploads/中华人民共和国社会保险法.pdf
2025-10-02 20:26:04.482 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 数据库文档删除成功: 中华人民共和国社会保险法.pdf (ID: 16)
2025-10-02 20:26:04.482 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 批量删除完成，成功: 2, 失败: 0
2025-10-02 20:26:04.484 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=27b178bd, method=DELETE, uri=/api/knowledge-base/documents, status=200, duration=41ms
2025-10-02 20:26:15.595 [http-nio-8080-exec-1] INFO  c.r.L.service.KnowledgeBaseService - 从数据库获取知识库统计信息: 总文档数=9, 分类数=2
2025-10-02 20:26:15.595 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=9efe4043, method=GET, uri=/api/knowledge-base/statistics, status=200, duration=7ms
2025-10-02 20:26:25.437 [http-nio-8080-exec-5] INFO  c.r.L.service.KnowledgeBaseService - 从数据库获取文档列表: 页码=0, 每页=20, 分类=null, 总数=9
2025-10-02 20:26:25.439 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fded9623, method=GET, uri=/api/knowledge-base/documents, status=200, duration=9ms
2025-10-02 20:27:07.011 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a18ca969, method=GET, uri=/api/knowledge-base/index/statistics, status=200, duration=7ms
2025-10-02 20:27:49.980 [http-nio-8080-exec-3] INFO  c.r.L.c.ChatMemoryController - 简单聊天（带记忆）请求: message=请你简要介绍一下美国的历史, conversationId=1, modelType=OLLAMA
2025-10-02 20:27:49.981 [http-nio-8080-exec-3] INFO  c.r.LegalAssistant.service.AiService - 处理简单聊天（带记忆）: conversationId=1, modelType=OLLAMA, message=请你简要介绍一下美国的历史
2025-10-02 20:28:15.422 [http-nio-8080-exec-3] INFO  c.r.LegalAssistant.service.AiService - 简单聊天（带记忆）响应生成成功: conversationId=1, modelType=OLLAMA
2025-10-02 20:28:15.423 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2599694a, method=POST, uri=/api/ai/memory/simple-chat, status=200, duration=25445ms
2025-10-02 20:28:44.322 [http-nio-8080-exec-2] INFO  c.r.L.c.ChatMemoryController - 简单聊天（带记忆）请求: message=请你简要介绍一下英国的历史, conversationId=1, modelType=DEEPSEEK
2025-10-02 20:28:44.323 [http-nio-8080-exec-2] INFO  c.r.LegalAssistant.service.AiService - 处理简单聊天（带记忆）: conversationId=1, modelType=DEEPSEEK, message=请你简要介绍一下英国的历史
2025-10-02 20:29:19.014 [http-nio-8080-exec-2] INFO  c.r.LegalAssistant.service.AiService - 简单聊天（带记忆）响应生成成功: conversationId=1, modelType=DEEPSEEK
2025-10-02 20:29:19.015 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4dc75657, method=POST, uri=/api/ai/memory/simple-chat, status=200, duration=34694ms
2025-10-02 20:29:47.029 [http-nio-8080-exec-8] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=OLLAMA
2025-10-02 20:29:47.030 [http-nio-8080-exec-8] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:29:47.032 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=10ac78b0, method=GET, uri=/api/ai/memory/history, status=200, duration=4ms
2025-10-02 20:29:52.061 [http-nio-8080-exec-7] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=DEEPSEEK
2025-10-02 20:29:52.062 [http-nio-8080-exec-7] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: deepseek)
2025-10-02 20:29:52.063 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ba10c59c, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:29:55.937 [http-nio-8080-exec-9] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=OLLAMA
2025-10-02 20:29:55.937 [http-nio-8080-exec-9] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:29:55.938 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a0a7186e, method=GET, uri=/api/ai/memory/history, status=200, duration=2ms
2025-10-02 20:30:05.077 [http-nio-8080-exec-4] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=OLLAMA
2025-10-02 20:30:05.077 [http-nio-8080-exec-4] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:30:05.079 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5d1e67b5, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:30:20.819 [http-nio-8080-exec-6] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:30:20.819 [http-nio-8080-exec-6] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:30:20.819 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=34fc791f, method=GET, uri=/api/ai/memory/exists, status=200, duration=1ms
2025-10-02 20:30:26.195 [http-nio-8080-exec-1] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: deepseek)
2025-10-02 20:30:26.195 [http-nio-8080-exec-1] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: deepseek)
2025-10-02 20:30:26.196 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ffa014e6, method=GET, uri=/api/ai/memory/exists, status=200, duration=2ms
2025-10-02 20:30:31.614 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d5a26488, method=GET, uri=/api/ai/memory/health, status=200, duration=2ms
2025-10-02 20:30:55.631 [http-nio-8080-exec-10] INFO  c.r.L.c.ChatMemoryController - 简单聊天（带记忆）请求: message=我刚刚问了什么问题, conversationId=1, modelType=DEEPSEEK
2025-10-02 20:30:55.631 [http-nio-8080-exec-10] INFO  c.r.LegalAssistant.service.AiService - 处理简单聊天（带记忆）: conversationId=1, modelType=DEEPSEEK, message=我刚刚问了什么问题
2025-10-02 20:31:00.707 [http-nio-8080-exec-10] INFO  c.r.LegalAssistant.service.AiService - 简单聊天（带记忆）响应生成成功: conversationId=1, modelType=DEEPSEEK
2025-10-02 20:31:00.708 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=dacc9473, method=POST, uri=/api/ai/memory/simple-chat, status=200, duration=5078ms
2025-10-02 20:31:18.085 [http-nio-8080-exec-3] INFO  c.r.L.c.ChatMemoryController - 清除聊天记忆请求: conversationId=1, modelType=DEEPSEEK
2025-10-02 20:31:18.086 [http-nio-8080-exec-3] INFO  c.r.L.service.ChatMemoryService - 成功清除会话 1 的聊天记忆 (模型: deepseek)
2025-10-02 20:31:18.087 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a8e7b168, method=DELETE, uri=/api/ai/memory/clear, status=200, duration=2ms
2025-10-02 20:31:22.026 [http-nio-8080-exec-2] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=DEEPSEEK
2025-10-02 20:31:22.026 [http-nio-8080-exec-2] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:31:22.027 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ee5b1117, method=GET, uri=/api/ai/memory/history, status=200, duration=2ms
2025-10-02 20:31:40.112 [http-nio-8080-exec-8] INFO  c.r.L.c.ChatMemoryController - 带聊天记忆的对话请求: message=介绍一下刑法, conversationId=2, modelType=OLLAMA
2025-10-02 20:31:40.112 [http-nio-8080-exec-8] INFO  c.r.LegalAssistant.service.AiService - 处理带聊天记忆的本地知识库聊天: conversationId=2, modelType=OLLAMA, question=介绍一下刑法
2025-10-02 20:31:40.112 [http-nio-8080-exec-8] INFO  c.r.L.service.RAGService - 使用自定义ChatClient执行RAG流程
2025-10-02 20:31:40.113 [http-nio-8080-exec-8] INFO  c.r.L.service.VectorStoreService - 搜索相似文档,查询: 介绍一下刑法, 最大结果数: 15
2025-10-02 20:31:40.911 [http-nio-8080-exec-8] INFO  c.r.L.service.VectorStoreService - Spring AI向量存储结果不足(4个),尝试LangChain4j向量存储作为补充
2025-10-02 20:31:41.033 [http-nio-8080-exec-8] INFO  c.r.L.service.VectorStoreService - 从LangChain4j向量存储补充 11 个结果
2025-10-02 20:31:41.033 [http-nio-8080-exec-8] INFO  c.r.L.service.VectorStoreService - 最终返回 15 个相似文档
2025-10-02 20:32:00.603 [http-nio-8080-exec-8] INFO  c.r.L.service.RAGService - RAG流程完成(自定义Client),使用了 15 个文档片段
2025-10-02 20:32:00.604 [http-nio-8080-exec-8] INFO  c.r.LegalAssistant.service.AiService - 带聊天记忆的本地知识库聊天响应生成成功: conversationId=2, modelType=OLLAMA, 使用了 15 个文档片段
2025-10-02 20:32:00.605 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=375ee5b1, method=POST, uri=/api/ai/memory/chat, status=200, duration=20494ms
2025-10-02 20:32:39.598 [http-nio-8080-exec-7] INFO  c.r.L.c.ChatMemoryController - 带聊天记忆的对话请求: message=介绍一下民法典, conversationId=2, modelType=DEEPSEEK
2025-10-02 20:32:39.598 [http-nio-8080-exec-7] INFO  c.r.LegalAssistant.service.AiService - 处理带聊天记忆的本地知识库聊天: conversationId=2, modelType=DEEPSEEK, question=介绍一下民法典
2025-10-02 20:32:39.599 [http-nio-8080-exec-7] INFO  c.r.L.service.RAGService - 使用自定义ChatClient执行RAG流程
2025-10-02 20:32:39.599 [http-nio-8080-exec-7] INFO  c.r.L.service.VectorStoreService - 搜索相似文档,查询: 介绍一下民法典, 最大结果数: 15
2025-10-02 20:32:39.716 [http-nio-8080-exec-7] INFO  c.r.L.service.VectorStoreService - Spring AI向量存储结果不足(0个),尝试LangChain4j向量存储作为补充
2025-10-02 20:32:39.971 [http-nio-8080-exec-7] INFO  c.r.L.service.VectorStoreService - 从LangChain4j向量存储补充 15 个结果
2025-10-02 20:32:39.972 [http-nio-8080-exec-7] INFO  c.r.L.service.VectorStoreService - 最终返回 15 个相似文档
2025-10-02 20:33:02.685 [http-nio-8080-exec-7] INFO  c.r.L.service.RAGService - RAG流程完成(自定义Client),使用了 15 个文档片段
2025-10-02 20:33:02.685 [http-nio-8080-exec-7] INFO  c.r.LegalAssistant.service.AiService - 带聊天记忆的本地知识库聊天响应生成成功: conversationId=2, modelType=DEEPSEEK, 使用了 15 个文档片段
2025-10-02 20:33:02.685 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=97ba6912, method=POST, uri=/api/ai/memory/chat, status=200, duration=23088ms
2025-10-02 20:33:30.161 [http-nio-8080-exec-9] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=DEEPSEEK
2025-10-02 20:33:30.161 [http-nio-8080-exec-9] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:33:30.162 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=bb867cc8, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:33:32.691 [http-nio-8080-exec-4] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=DEEPSEEK
2025-10-02 20:33:32.692 [http-nio-8080-exec-4] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:33:32.694 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1e7cd62c, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:33:34.691 [http-nio-8080-exec-6] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=OLLAMA
2025-10-02 20:33:34.692 [http-nio-8080-exec-6] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:33:34.694 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7ded2c96, method=GET, uri=/api/ai/memory/history, status=200, duration=4ms
2025-10-02 20:33:47.197 [http-nio-8080-exec-1] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=OLLAMA
2025-10-02 20:33:47.197 [http-nio-8080-exec-1] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:33:47.198 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2549f353, method=GET, uri=/api/ai/memory/history, status=200, duration=2ms
2025-10-02 20:33:49.452 [http-nio-8080-exec-5] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=DEEPSEEK
2025-10-02 20:33:49.453 [http-nio-8080-exec-5] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:33:49.454 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=56c7b2d1, method=GET, uri=/api/ai/memory/history, status=200, duration=2ms
2025-10-02 20:34:03.690 [http-nio-8080-exec-10] INFO  c.r.L.c.ChatMemoryController - 带聊天记忆的对话请求: message=我问了你什么问题, conversationId=2, modelType=DEEPSEEK
2025-10-02 20:34:03.690 [http-nio-8080-exec-10] INFO  c.r.LegalAssistant.service.AiService - 处理带聊天记忆的本地知识库聊天: conversationId=2, modelType=DEEPSEEK, question=我问了你什么问题
2025-10-02 20:34:03.691 [http-nio-8080-exec-10] INFO  c.r.L.service.RAGService - 使用自定义ChatClient执行RAG流程
2025-10-02 20:34:03.691 [http-nio-8080-exec-10] INFO  c.r.L.service.VectorStoreService - 搜索相似文档,查询: 我问了你什么问题, 最大结果数: 15
2025-10-02 20:34:03.751 [http-nio-8080-exec-10] INFO  c.r.L.service.VectorStoreService - Spring AI向量存储结果不足(0个),尝试LangChain4j向量存储作为补充
2025-10-02 20:34:03.956 [http-nio-8080-exec-10] INFO  c.r.L.service.VectorStoreService - 从LangChain4j向量存储补充 15 个结果
2025-10-02 20:34:03.957 [http-nio-8080-exec-10] INFO  c.r.L.service.VectorStoreService - 最终返回 15 个相似文档
2025-10-02 20:34:10.760 [http-nio-8080-exec-10] INFO  c.r.L.service.RAGService - RAG流程完成(自定义Client),使用了 15 个文档片段
2025-10-02 20:34:10.760 [http-nio-8080-exec-10] INFO  c.r.LegalAssistant.service.AiService - 带聊天记忆的本地知识库聊天响应生成成功: conversationId=2, modelType=DEEPSEEK, 使用了 15 个文档片段
2025-10-02 20:34:10.761 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=bc4b2713, method=POST, uri=/api/ai/memory/chat, status=200, duration=7072ms
2025-10-02 20:34:16.123 [http-nio-8080-exec-3] INFO  c.r.L.c.ChatMemoryController - 带聊天记忆的对话请求: message=我问了你什么问题, conversationId=2, modelType=OLLAMA
2025-10-02 20:34:16.123 [http-nio-8080-exec-3] INFO  c.r.LegalAssistant.service.AiService - 处理带聊天记忆的本地知识库聊天: conversationId=2, modelType=OLLAMA, question=我问了你什么问题
2025-10-02 20:34:16.123 [http-nio-8080-exec-3] INFO  c.r.L.service.RAGService - 使用自定义ChatClient执行RAG流程
2025-10-02 20:34:16.124 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - 搜索相似文档,查询: 我问了你什么问题, 最大结果数: 15
2025-10-02 20:34:16.221 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - Spring AI向量存储结果不足(0个),尝试LangChain4j向量存储作为补充
2025-10-02 20:34:16.471 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - 从LangChain4j向量存储补充 15 个结果
2025-10-02 20:34:16.471 [http-nio-8080-exec-3] INFO  c.r.L.service.VectorStoreService - 最终返回 15 个相似文档
2025-10-02 20:34:23.864 [http-nio-8080-exec-3] INFO  c.r.L.service.RAGService - RAG流程完成(自定义Client),使用了 15 个文档片段
2025-10-02 20:34:23.864 [http-nio-8080-exec-3] INFO  c.r.LegalAssistant.service.AiService - 带聊天记忆的本地知识库聊天响应生成成功: conversationId=2, modelType=OLLAMA, 使用了 15 个文档片段
2025-10-02 20:34:23.865 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=50cdc693, method=POST, uri=/api/ai/memory/chat, status=200, duration=7744ms
2025-10-02 20:34:39.722 [http-nio-8080-exec-2] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=DEEPSEEK
2025-10-02 20:34:39.723 [http-nio-8080-exec-2] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:34:39.725 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=dd7a95a0, method=GET, uri=/api/ai/memory/history, status=200, duration=4ms
2025-10-02 20:34:43.057 [http-nio-8080-exec-8] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=OLLAMA
2025-10-02 20:34:43.057 [http-nio-8080-exec-8] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:34:43.059 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=78687780, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:34:55.151 [http-nio-8080-exec-7] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=2, modelType=OLLAMA
2025-10-02 20:34:55.152 [http-nio-8080-exec-7] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:34:55.153 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=39131f52, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:35:00.953 [http-nio-8080-exec-9] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=OLLAMA
2025-10-02 20:35:00.955 [http-nio-8080-exec-9] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:35:00.955 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=930a638d, method=GET, uri=/api/ai/memory/history, status=200, duration=2ms
2025-10-02 20:36:35.762 [http-nio-8080-exec-6] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:36:35.763 [http-nio-8080-exec-6] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:36:35.764 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2cad9be5, method=GET, uri=/api/ai/memory/exists, status=200, duration=4ms
2025-10-02 20:36:40.551 [http-nio-8080-exec-1] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:36:40.551 [http-nio-8080-exec-1] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 2 条消息 (模型: ollama)
2025-10-02 20:36:40.552 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c233da4a, method=GET, uri=/api/ai/memory/exists, status=200, duration=2ms
2025-10-02 20:36:42.963 [http-nio-8080-exec-5] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:36:42.964 [http-nio-8080-exec-5] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:36:42.965 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2583a4a2, method=GET, uri=/api/ai/memory/exists, status=200, duration=4ms
2025-10-02 20:36:45.535 [http-nio-8080-exec-10] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:36:45.536 [http-nio-8080-exec-10] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 2 的聊天历史，共 0 条消息 (模型: deepseek)
2025-10-02 20:36:45.537 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=63831b27, method=GET, uri=/api/ai/memory/exists, status=200, duration=2ms
2025-10-02 20:37:59.616 [http-nio-8080-exec-2] INFO  c.r.L.c.ChatMemoryController - 清除聊天记忆请求: conversationId=1, modelType=DEEPSEEK
2025-10-02 20:37:59.616 [http-nio-8080-exec-2] INFO  c.r.L.service.ChatMemoryService - 成功清除会话 1 的聊天记忆 (模型: deepseek)
2025-10-02 20:37:59.617 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=7d238abc, method=DELETE, uri=/api/ai/memory/clear, status=200, duration=4ms
2025-10-02 20:38:02.956 [http-nio-8080-exec-8] INFO  c.r.L.c.ChatMemoryController - 清除聊天记忆请求: conversationId=1, modelType=OLLAMA
2025-10-02 20:38:02.956 [http-nio-8080-exec-8] INFO  c.r.L.service.ChatMemoryService - 成功清除会话 1 的聊天记忆 (模型: ollama)
2025-10-02 20:38:02.957 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e2f79ab3, method=DELETE, uri=/api/ai/memory/clear, status=200, duration=2ms
2025-10-02 20:38:06.329 [http-nio-8080-exec-7] INFO  c.r.L.c.ChatMemoryController - 获取聊天历史请求: conversationId=1, modelType=OLLAMA
2025-10-02 20:38:06.330 [http-nio-8080-exec-7] INFO  c.r.L.service.ChatMemoryService - 成功获取会话 1 的聊天历史，共 0 条消息 (模型: ollama)
2025-10-02 20:38:06.331 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=115530ed, method=GET, uri=/api/ai/memory/history, status=200, duration=3ms
2025-10-02 20:46:06.106 [http-nio-8080-exec-4] ERROR c.r.L.c.ContractReviewController - 文件上传失败
java.lang.IllegalArgumentException: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:102)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.uploadContract(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-02 20:46:06.112 [http-nio-8080-exec-4] ERROR c.r.L.e.GlobalExceptionHandler - 运行时异常
java.lang.RuntimeException: 文件上传失败: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:133)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:355)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.proceed(AuthorizationManagerBeforeMethodInterceptor.java:269)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:264)
	at org.springframework.security.authorization.method.AuthorizationManagerBeforeMethodInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:197)
	at org.springframework.security.config.annotation.method.configuration.DeferringMethodInterceptor.invoke(DeferringMethodInterceptor.java:44)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:768)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:720)
	at com.river.LegalAssistant.controller.ContractReviewController$$SpringCGLIB$$0.uploadContract(<generated>)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:255)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:188)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.IllegalArgumentException: 不支持的文件类型，支持的类型: pdf, docx, doc, txt, rtf, odt, md
	at com.river.LegalAssistant.controller.ContractReviewController.uploadContract(ContractReviewController.java:102)
	... 152 common frames omitted
2025-10-02 20:46:06.118 [http-nio-8080-exec-4] ERROR c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=ea68d46c, method=POST, uri=/api/api/contracts/upload, status=500, duration=17ms
2025-10-02 20:46:51.341 [http-nio-8080-exec-6] ERROR c.r.L.e.GlobalExceptionHandler - 未处理的异常
org.springframework.web.HttpMediaTypeNotSupportedException: Content-Type 'application/x-www-form-urlencoded;charset=UTF-8' is not supported
	at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMethodArgumentResolver.readWithMessageConverters(AbstractMessageConverterMethodArgumentResolver.java:213)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.readWithMessageConverters(RequestResponseBodyMethodProcessor.java:161)
	at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodProcessor.resolveArgument(RequestResponseBodyMethodProcessor.java:135)
	at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:122)
	at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:224)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:178)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:926)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:831)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:925)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:593)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RateLimitFilter.doFilter(RateLimitFilter.java:76)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at com.river.LegalAssistant.filter.RequestTrackingFilter.doFilter(RequestTrackingFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:108)
	at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(FilterChainProxy.java:231)
	at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservation$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
	at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecured$0(ObservationFilterChainDecorator.java:82)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:128)
	at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(AuthorizationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:126)
	at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:120)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:100)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:63)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilterInternal(BasicAuthenticationFilter.java:213)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:227)
	at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:221)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:107)
	at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:93)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderWriterFilter.java:90)
	at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(HeaderWriterFilter.java:75)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:82)
	at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(SecurityContextHolderFilter.java:69)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:227)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(DisableEncodeUrlFilter.java:42)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.wrapFilter(ObservationFilterChainDecorator.java:240)
	at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObservation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
	at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilter.doFilter(ObservationFilterChainDecorator.java:224)
	at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterChain.doFilter(ObservationFilterChainDecorator.java:137)
	at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:233)
	at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:191)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createCacheFilter$3(HandlerMappingIntrospector.java:195)
	at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(CompositeFilter.java:113)
	at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
	at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityConfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:230)
	at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:352)
	at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:268)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:113)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:115)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:384)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:905)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1741)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1190)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-10-02 20:46:51.347 [http-nio-8080-exec-6] ERROR c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=afe115c6, method=PUT, uri=/api/knowledge-base/documents/9, status=500, duration=8ms
2025-10-02 20:52:27.084 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-02 20:52:27.090 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-10-02 20:53:07.783 [main] INFO  c.r.L.LegalAssistantApplication - Starting LegalAssistantApplication using Java 21.0.5 with PID 26936 (F:\LegalAssistant\target\classes started by river in F:\LegalAssistant)
2025-10-02 20:53:07.784 [main] INFO  c.r.L.LegalAssistantApplication - No active profile set, falling back to 1 default profile: "default"
2025-10-02 20:53:10.005 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-10-02 20:53:10.137 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection org.postgresql.jdbc.PgConnection@433db56d
2025-10-02 20:53:10.190 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-10-02 20:53:10.208 [main] INFO  org.flywaydb.core.FlywayExecutor - Database: jdbc:postgresql://localhost:5432/legal_assistant (PostgreSQL 17.6)
2025-10-02 20:53:10.215 [main] WARN  o.f.c.i.database.base.Database - Flyway upgrade recommended: PostgreSQL 17.6 is newer than this version of Flyway and support has not been tested. The latest supported version of PostgreSQL is 16.
2025-10-02 20:53:10.407 [main] INFO  o.f.core.internal.command.DbMigrate - Current version of schema "public": 10
2025-10-02 20:53:10.409 [main] INFO  o.f.core.internal.command.DbMigrate - Schema "public" is up to date. No migration necessary.
2025-10-02 20:53:10.827 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: PostgreSQLDialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-10-02 20:53:11.562 [main] INFO  c.r.L.service.PromptTemplateService - 开始初始化提示词模板服务...
2025-10-02 20:53:11.563 [main] INFO  c.r.L.service.PromptTemplateService - 提示词模板服务初始化完成，共加载 7 个模板
2025-10-02 20:53:11.582 [main] INFO  c.r.L.config.OllamaConfig - === Ollama 配置初始化 ===
2025-10-02 20:53:11.582 [main] INFO  c.r.L.config.OllamaConfig - 使用本地 Ollama 服务，不依赖任何云端 AI 服务
2025-10-02 20:53:11.582 [main] INFO  c.r.L.config.OllamaConfig - 确保 Ollama 服务运行在 http://localhost:11434
2025-10-02 20:53:11.582 [main] INFO  c.r.L.config.OllamaConfig - 推荐模型:
2025-10-02 20:53:11.582 [main] INFO  c.r.L.config.OllamaConfig -   - 聊天模型: qwen2:1.5b, llama3.2:3b
2025-10-02 20:53:11.582 [main] INFO  c.r.L.config.OllamaConfig -   - 嵌入模型: nomic-embed-text
2025-10-02 20:53:11.583 [main] INFO  c.r.L.config.OllamaConfig - ========================
2025-10-02 20:53:11.882 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 嵌入模型: nomic-embed-text
2025-10-02 20:53:11.999 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j PGVector 嵌入存储（独立表）
2025-10-02 20:53:12.000 [main] INFO  c.r.L.config.LangChain4jConfig - 连接 PGVector 数据库: localhost:5432/legal_assistant, 表: langchain4j_embeddings, 维度: 768
2025-10-02 20:53:12.677 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化主要聊天客户端，优先使用DeepSeek模型
2025-10-02 20:53:12.716 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆存储库（内存存储）
2025-10-02 20:53:12.718 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建Ollama聊天记忆，最大消息数: 15
2025-10-02 20:53:12.722 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆存储库（内存存储）
2025-10-02 20:53:12.722 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建DeepSeek聊天记忆，最大消息数: 30
2025-10-02 20:53:12.723 [main] INFO  c.r.L.service.ChatMemoryService - 聊天记忆服务初始化完成
2025-10-02 20:53:12.753 [main] INFO  c.r.LegalAssistant.config.AiConfig - 设置 Ollama Embedding 模型为主要嵌入模型
2025-10-02 20:53:12.916 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Using the vector table name: vector_store. Is empty: false
2025-10-02 20:53:12.918 [main] INFO  o.s.a.v.pgvector.PgVectorStore - Initializing PGVectorStore schema for table: vector_store in schema: public
2025-10-02 20:53:12.918 [main] INFO  o.s.a.v.pgvector.PgVectorStore - vectorTableValidationsEnabled false
2025-10-02 20:53:12.919 [main] DEBUG o.s.a.v.pgvector.PgVectorStore - Skipping the schema initialization for the table: public.vector_store
2025-10-02 20:53:12.944 [main] INFO  c.r.L.service.AgentService - 混合AI法律顾问代理服务启动
2025-10-02 20:53:12.946 [main] INFO  c.r.L.service.AgentService - 正在初始化混合AI法律顾问代理服务...
2025-10-02 20:53:12.946 [main] INFO  c.r.L.service.AgentService - 配置：混合模式=true, 基础提供者=ollama, 高级提供者=deepseek, 自动降级=true
2025-10-02 20:53:12.946 [main] INFO  c.r.L.service.AgentService - 初始化基础AI服务：ollama (qwen2:1.5b)
2025-10-02 20:53:12.952 [main] INFO  c.r.L.service.AgentService - 基础AI服务初始化成功：qwen2:1.5b
2025-10-02 20:53:12.952 [main] INFO  c.r.L.service.AgentService - 初始化高级AI服务：deepseek (deepseek-chat)
2025-10-02 20:53:12.974 [main] INFO  c.r.L.service.AgentService - 高级AI服务初始化成功：deepseek-chat
2025-10-02 20:53:12.974 [main] INFO  c.r.L.service.AgentService - === 混合AI法律顾问服务初始化完成 ===
2025-10-02 20:53:12.974 [main] INFO  c.r.L.service.AgentService - 基础服务状态：可用 (qwen2:1.5b)
2025-10-02 20:53:12.975 [main] INFO  c.r.L.service.AgentService - 高级服务状态：可用 (deepseek-chat)
2025-10-02 20:53:12.975 [main] INFO  c.r.L.service.AgentService - 自动降级：启用
2025-10-02 20:53:12.975 [main] INFO  c.r.L.service.AgentService - 混合AI架构完全就绪，智能路由已激活。
2025-10-02 20:53:12.975 [main] INFO  c.r.L.service.AgentService - ========================================
2025-10-02 20:53:12.982 [main] INFO  c.r.L.config.LangChain4jConfig - 初始化 LangChain4j 聊天模型: qwen2:1.5b
2025-10-02 20:53:12.997 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 初始化法律查询路由器...
2025-10-02 20:53:12.997 [main] INFO  c.r.L.s.advanced.LegalQueryRouter - 法律查询路由器初始化完成，配置 6 个检索器
2025-10-02 20:53:13.019 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 开始初始化 Advanced Legal RAG 服务...
2025-10-02 20:53:13.019 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG 检索增强器...
2025-10-02 20:53:13.021 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 检索增强器构建完成
2025-10-02 20:53:13.022 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - 构建 Advanced RAG AI 服务...
2025-10-02 20:53:13.023 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced RAG AI 服务构建完成
2025-10-02 20:53:13.023 [main] INFO  c.r.L.s.a.AdvancedLegalRagService - Advanced Legal RAG 服务初始化成功
2025-10-02 20:53:13.440 [main] INFO  c.r.L.service.EtlService - ETL服务初始化完成 - chunk大小: 0, 重叠: 0, 最小块: 0
2025-10-02 20:53:13.515 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化基础聊天客户端，使用Ollama Chat模型
2025-10-02 20:53:13.517 [main] INFO  c.r.LegalAssistant.config.AiConfig - 初始化高级聊天客户端，使用DeepSeek Chat模型
2025-10-02 20:53:13.519 [main] INFO  c.r.L.config.AsyncConfig - 合同分析异步任务执行器初始化完成: 核心线程数=2, 最大线程数=4, 队列容量=50
2025-10-02 20:53:13.534 [main] INFO  c.r.L.config.AsyncConfig - 通用异步任务执行器初始化完成
2025-10-02 20:53:13.562 [main] INFO  c.r.L.config.ChatMemoryConfig - 创建默认聊天记忆，使用Ollama聊天记忆
2025-10-02 20:53:13.718 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-10-02 20:53:13.767 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name userService
2025-10-02 20:53:14.481 [main] WARN  o.s.b.a.t.ThymeleafAutoConfiguration$DefaultTemplateResolverConfiguration - Cannot find template location: classpath:/templates/ (please add some templates, check your Thymeleaf configuration, or set spring.thymeleaf.check-template-location=false)
2025-10-02 20:53:15.387 [main] INFO  c.r.L.LegalAssistantApplication - Started LegalAssistantApplication in 7.994 seconds (process running for 8.263)
2025-10-02 20:53:15.391 [main] INFO  c.r.L.config.StartupIndexer - 检查是否需要索引法律文档...
2025-10-02 20:53:15.393 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 发现 6 个法律文档，检查是否需要索引...
2025-10-02 20:53:15.481 [ForkJoinPool.commonPool-worker-1] INFO  c.r.L.config.StartupIndexer - 所有法律文档都已被索引，跳过自动索引
2025-10-02 20:53:19.583 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=882e3cb4, method=GET, uri=/api/doc.html, status=200, duration=11ms
2025-10-02 20:53:19.776 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=10f28f3c, method=GET, uri=/api/webjars/css/chunk-vendors.f24a310a.css, status=200, duration=10ms
2025-10-02 20:53:19.781 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=019173c0, method=GET, uri=/api/webjars/js/app.c31badf5.js, status=200, duration=14ms
2025-10-02 20:53:19.782 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5351cb4a, method=GET, uri=/api/webjars/css/app.1824bac3.css, status=200, duration=15ms
2025-10-02 20:53:19.802 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=d8c245a0, method=GET, uri=/api/webjars/js/chunk-vendors.d51cf6f8.js, status=200, duration=35ms
2025-10-02 20:53:19.896 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=66d1a60a, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=5ms
2025-10-02 20:53:19.896 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=9f654ce3, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=5ms
2025-10-02 20:53:19.897 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c446d3d8, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=6ms
2025-10-02 20:53:19.900 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=35b0bbd8, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=7ms
2025-10-02 20:53:19.902 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=143f2278, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=9ms
2025-10-02 20:53:19.912 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=5f5770b2, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=3ms
2025-10-02 20:53:19.912 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e89d157d, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=3ms
2025-10-02 20:53:19.914 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=97d7fa45, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=3ms
2025-10-02 20:53:19.915 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=c06d3aab, method=GET, uri=/api/webjars/js/chunk-2d0da532.591ad7fc.js, status=200, duration=3ms
2025-10-02 20:53:19.926 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2a318d18, method=GET, uri=/api/webjars/js/chunk-260d712a.390177fe.js, status=200, duration=17ms
2025-10-02 20:53:19.926 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=32a81481, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=6ms
2025-10-02 20:53:19.928 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=80e29fd0, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=7ms
2025-10-02 20:53:19.932 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=56ae5802, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=4ms
2025-10-02 20:53:19.935 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e2d1796c, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=7ms
2025-10-02 20:53:19.936 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=4c960449, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=3ms
2025-10-02 20:53:19.942 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=e6365a84, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=6ms
2025-10-02 20:53:20.187 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=1954fdfc, method=GET, uri=/api/v3/api-docs/swagger-config, status=200, duration=37ms
2025-10-02 20:53:20.602 [http-nio-8080-exec-8] INFO  o.s.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 394 ms
2025-10-02 20:53:20.623 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=035f02fc, method=GET, uri=/api/v3/api-docs, status=200, duration=427ms
2025-10-02 20:53:20.713 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=3febd274, method=GET, uri=/api/webjars/css/chunk-41ae0dec.999bc9fd.css, status=200, duration=2ms
2025-10-02 20:53:20.713 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2d627979, method=GET, uri=/api/webjars/css/chunk-cdc6d52e.9612b987.css, status=200, duration=2ms
2025-10-02 20:53:20.713 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=23962dec, method=GET, uri=/api/webjars/js/chunk-41ae0dec.7cdc472b.js, status=200, duration=2ms
2025-10-02 20:53:20.713 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=946e9c72, method=GET, uri=/api/webjars/js/chunk-adb9e944.2c7f24fe.js, status=200, duration=2ms
2025-10-02 20:53:20.713 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=aee6e58e, method=GET, uri=/api/webjars/js/chunk-069eb437.355c4fb0.js, status=200, duration=2ms
2025-10-02 20:53:20.723 [http-nio-8080-exec-10] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a08e785b, method=GET, uri=/api/webjars/js/chunk-cdc6d52e.5c46a8aa.js, status=200, duration=4ms
2025-10-02 20:53:20.767 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=0a8ac145, method=GET, uri=/api/webjars/js/chunk-2d0af44e.392afcd6.js, status=200, duration=3ms
2025-10-02 20:53:20.767 [http-nio-8080-exec-9] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=2e21a405, method=GET, uri=/api/webjars/js/chunk-3b888a65.8737ce4f.js, status=200, duration=3ms
2025-10-02 20:53:20.767 [http-nio-8080-exec-4] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=abf33faa, method=GET, uri=/api/webjars/js/chunk-3ec4aaa8.a79d19f8.js, status=200, duration=3ms
2025-10-02 20:53:20.777 [http-nio-8080-exec-8] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cdbfc822, method=GET, uri=/api/webjars/js/chunk-2d0bd799.eb48b7f1.js, status=200, duration=2ms
2025-10-02 20:53:26.766 [http-nio-8080-exec-1] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=aca9fa67, method=GET, uri=/api/webjars/js/chunk-0d102d5a.b2bddffc.js, status=200, duration=3ms
2025-10-02 20:53:26.766 [http-nio-8080-exec-5] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=edccc112, method=GET, uri=/api/webjars/js/chunk-589faee0.5bfd1708.js, status=200, duration=3ms
2025-10-02 20:53:26.768 [http-nio-8080-exec-3] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cc8986e1, method=GET, uri=/api/webjars/js/chunk-0fd67716.d57e2c41.js, status=200, duration=5ms
2025-10-02 20:53:36.886 [http-nio-8080-exec-7] INFO  c.r.L.service.FileStorageService - 文件保存成功: F:\LegalAssistant\uploads\contracts\bf28389098fa937be57de5fa649c01f7b136b425a044e3dfd55d13dd1412502f_农村土地经营权出租合同.docx, 大小: 30836 bytes
2025-10-02 20:53:36.895 [http-nio-8080-exec-7] INFO  c.r.L.service.ContractReviewService - 从文件流创建合同审查记录，用户: admin, 文件: 农村土地经营权出租合同.docx
2025-10-02 20:53:36.896 [http-nio-8080-exec-7] INFO  c.r.L.service.DocumentParserService - 开始解析文档: 农村土地经营权出租合同.docx, 类型: docx, 大小: 30836 bytes
2025-10-02 20:53:37.639 [http-nio-8080-exec-7] INFO  c.r.L.service.DocumentParserService - 文档解析成功: 农村土地经营权出租合同.docx, 内容长度: 3686 字符
2025-10-02 20:53:37.640 [http-nio-8080-exec-7] INFO  c.r.L.service.ContractReviewService - 创建合同审查记录，用户: admin, 文件: 农村土地经营权出租合同.docx
2025-10-02 20:53:37.703 [http-nio-8080-exec-7] INFO  c.r.L.service.ContractReviewService - 合同审查记录已保存 - ID: 6, 原始文件名: 农村土地经营权出租合同.docx, 文件路径: F:\LegalAssistant\uploads\contracts\bf28389098fa937be57de5fa649c01f7b136b425a044e3dfd55d13dd1412502f_农村土地经营权出租合同.docx
2025-10-02 20:53:37.703 [http-nio-8080-exec-7] INFO  c.r.L.service.EtlService - 开始处理文本内容，长度: 3686 字符
2025-10-02 20:53:37.709 [http-nio-8080-exec-7] INFO  c.r.L.service.EtlService - 文本分块完成，生成 403 个文本块
2025-10-02 20:53:45.068 [http-nio-8080-exec-7] INFO  c.r.L.service.EtlService - 文本内容处理完成，403 个向量块已存储
2025-10-02 20:53:45.069 [http-nio-8080-exec-7] INFO  c.r.L.service.ContractReviewService - 已成功使用EtlService将合同内容添加到AI知识库，审查ID: 6, 块数: 403
2025-10-02 20:53:45.081 [http-nio-8080-exec-7] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=cb68409d, method=POST, uri=/api/api/contracts/upload, status=200, duration=8262ms
2025-10-02 20:53:45.096 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=483b9450, method=GET, uri=/api/webjars/js/chunk-735c675c.5b409314.js, status=200, duration=3ms
2025-10-02 20:54:05.837 [http-nio-8080-exec-10] INFO  c.r.L.c.KnowledgeBaseController - 管理员更新文档元数据 (表单): 1
2025-10-02 20:54:05.838 [http-nio-8080-exec-10] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=930454da, method=PUT, uri=/api/knowledge-base/documents/1/form, status=400, duration=5ms
2025-10-02 20:54:16.767 [http-nio-8080-exec-2] INFO  c.r.L.service.KnowledgeBaseService - 从数据库获取文档列表: 页码=0, 每页=20, 分类=null, 总数=9
2025-10-02 20:54:16.770 [http-nio-8080-exec-2] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=b47aaee5, method=GET, uri=/api/knowledge-base/documents, status=200, duration=28ms
2025-10-02 20:54:38.640 [http-nio-8080-exec-1] INFO  c.r.L.c.KnowledgeBaseController - 管理员更新文档元数据 (表单): 12
2025-10-02 20:54:38.641 [http-nio-8080-exec-1] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=577f789d, method=PUT, uri=/api/knowledge-base/documents/12/form, status=404, duration=2ms
2025-10-02 20:54:43.556 [http-nio-8080-exec-3] INFO  c.r.L.c.KnowledgeBaseController - 管理员更新文档元数据 (表单): 13
2025-10-02 20:54:43.557 [http-nio-8080-exec-3] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=a8965cfe, method=PUT, uri=/api/knowledge-base/documents/13/form, status=404, duration=2ms
2025-10-02 20:54:46.600 [http-nio-8080-exec-7] INFO  c.r.L.c.KnowledgeBaseController - 管理员更新文档元数据 (表单): 14
2025-10-02 20:54:46.602 [http-nio-8080-exec-7] WARN  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=539a4697, method=PUT, uri=/api/knowledge-base/documents/14/form, status=404, duration=3ms
2025-10-02 20:54:52.653 [http-nio-8080-exec-6] INFO  c.r.L.service.KnowledgeBaseService - 从数据库获取文档列表: 页码=0, 每页=20, 分类=null, 总数=9
2025-10-02 20:54:52.655 [http-nio-8080-exec-6] INFO  c.r.L.filter.RequestTrackingFilter - [REQUEST_END] traceId=fe853dce, method=GET, uri=/api/knowledge-base/documents, status=200, duration=13ms
2025-10-02 20:55:13.366 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-10-02 20:55:13.369 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
